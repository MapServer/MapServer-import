<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.1.2//EN"
  "http://mapserver.gis.umn.edu/mdp/docbkx412/docbookx.dtd">
<!-- $Id: cgi-reference_es.xml,v 1.3 2002/11/25 20:38:22 msdoc Exp $ -->
<article lang="es">
  <articleinfo>
    <title>Referencia CGI de Mapserver</title>
    <author>
      <firstname>Stephen </firstname>
      <surname>Lime</surname>
      <affiliation>
        <orgname>Minnesota Department of Natural Resources</orgname>
        <address>
			<email>steve.lime@dnr.state.mn.us</email>
        </address>
      </affiliation>
    </author>
	<author>
		<firstname>Frank</firstname>
		<surname>Koormann</surname>
		<affiliation>
			<orgname>Intevation GmbH</orgname>
			<address>
				<email>frank.koormann@intevation.de</email>
			</address>
		</affiliation>
	</author>
	
		<othercredit>
     		<contrib>Traducción al Español</contrib>
     		<firstname>René</firstname>
     		<surname>Viáncos</surname>
     		<affiliation>
        		<orgname>Universidad Tecnológica Metropolitana</orgname>
         			<orgdiv>Departamenteo de Cartofrafía</orgdiv>
        			<address>
            			<email>rviancos@utem.cl</email>
        			</address>
     		</affiliation>
  		</othercredit>	
	
	
    <abstract>
      <para>Este documento es una referencia del mapserv CGI
        versión 3.5.        </para>
      <para>Ultima Actualización:  31-01-2002</para>
    </abstract>
  </articleinfo>
  <sect1 id="intro">
    <title>MapServer - Documentación: Referencia CGI</title>
    <para> Mapserv es la porción CGI del paquete MapServer. Este procesa
      las entradas del usuario y dirige la creación de las imágenes y los resultados de las consultas.
      El programa acepta entradas a traves de los metodos &quot;GET&quot; o
      &quot;POST&quot; y puede ser utilizado de una manera interactiva como un motor de imágenes.   </para>
	</sect1>
    <!-- NOTES on syntax -->
    <sect1 id="notes">
      <title>Notas</title>
      <itemizedlist>
        <listitem>
          <para>Los nombres de las Variables no son sensibles a Mayúsculas/Minúsculas.</para>
        </listitem>
        <listitem>
          <para>En casos donde multiples valores están asociados con una variable (v.gr. mapext), los valores deben estar seperados por espacios (o sus sentecias de escape equivalentes para peticiones de tipo GET).</para>
        </listitem>
        <listitem>
          <para>Los contenidos de las variables son chequeados para comprobar los tipos de datos y su magnitud en el momento de ser almacenados.</para>
        </listitem>
        <listitem>
            <para>
                Cualquier Variable CGI listada a continuación es almacenada y puede 
                ser referida dentro de un <ulink url="template-reference.html">Archivo plantilla</ulink>. 
            </para>
        </listitem>
      </itemizedlist>
    </sect1>
	
    <!-- Format -->
    <sect1 id="format">
      <title>Formato</title>
      <para>Mapserv acepta entradas en forma de variables CGI como se describe a continuación.</para>
		<sect2 id="cgi-variables">
        <title>Variables CGI</title>
      	<variablelist>
        	<varlistentry>
          	<term>BUFFER [distancia]</term>
          	<listitem>
            <para>Una distancia, en el mismo sistema de coordenadas definido en el mapfile, usado en conjunto con MAPXY para crear una nueva extención del mapa (map extent). </para>
          </listitem>
        </varlistentry>
            
        <varlistentry>
            <term>ID</term>
	           <listitem>
                    <para> 
			Por defecto MapServer genera a unico id de sesión
			basado en la hora del sistema y el id de la sesión.  ???
			Este parámetro sobreescribe el valor por defecto.
	            </para>
		    <para>
		        Como Ejemplo este parámetro puede ser utilizado para manipular 
			mapfiles personalizados en conjunto con la opción SAVEMAP.
		    </para>
                </listitem>
            </varlistentry>
	        
        <varlistentry>
          <term>IMG</term>
          <listitem>
            <para> El nombre asociado con la imagen del mapa actual usado
              para registrar los clicks del usuario. Este es pasaso por medio de dos variables, img.x e img.y.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>IMGBOX [x1] [y1] [x2] [y2]</term>
          <listitem>
            <para> Coordenadas (en pixeles) de un recuadro sobre la imagen.
              Muchas veces utilizado en conjunto con interfaces basadas en Java hacia MapServer.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>IMGEXT [minx] [miny] [maxx] [maxy]</term>
          <listitem>
            <para> La Extensión espacial de la imagen actual, que corresponde
              a la imagen que el usuario ve actualmente en su explorador de internet.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
            <term>IMGSHAPE [x1 y1 x2 y2 x3 y3 ...]</term>
	        <listitem>
                <para> 
                    borde dado en coordenadas de imagen.
                </para>
                <para>
                    Un borde arbitrario de un polígono para ser usado con fines de consultas.
					Multiples instancias simplemente agregan partes al borde, por lo que es posible construir un 
					poligono con agujeros. Utilizado con los modos NQUERY y NQUERYMAP. 
	            </para>
            </listitem>
        </varlistentry>
        <varlistentry>
          <term>IMGSIZE [columnas] [filas]</term>
          <listitem>
            <para> EL tamaño (en pixeles) de la imagen actual.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>IMGXY [x] [y]</term>
          <listitem>
            <para> Coordenadas (in pixeles) de un click del mouse sobre la imagen. Utilizado muchas veces en conjunto con
			       interfaces basadas en Java que interatuan con MapServer.</para>
          </listitem>
        </varlistentry>
<!-- Comment by Steve Lime: Not used in version 3.5
        <varlistentry>
            <term>ITEM [name]</term>
	        <listitem>
                <para>
                    The name of an attribute in a layer attribute table. 
                    Used for item/value lookups.
	            </para>
            </listitem>
        </varlistentry>
-->
        <varlistentry>
          <term>LAYER [name]</term>
          <listitem>
            <para> El nombre de un layer (capa) que aparece en el<ulink
                url="mapfile-reference.html">map file</ulink>. Enviando a 
              mapserv el nombre de un layer, se establece cuales layers pueden visualizarse (STATUS ON).</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>LAYERS [nombre nombre ...]</term>
          <listitem>
            <para> Los nombres de los layers que serán activados para su visualización. Estos nombres
			       deben estar separados por espacios.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>MAP [nombre_de_aarchivo]</term>
          <listitem>
            <para> Ruta del sistema de archivos (Path), relativo al directorio CGI, del <ulink
                url="mapfile-reference.html">map file</ulink> que será utilizado.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>MAPEXT [minx] [miny] [maxx] [maxy]</term>
          <listitem>
            <para> La extención espacial del mapa que será creado.    </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>MAPSIZE [columnas] [filas]</term>
          <listitem>
            <para> Tamaño (en píxeles) de la imagen que será creda.
              Muy Utilizado para permitir a los usuarios cambiar la resolución del mapa de salida dinámicamente.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>MAPSHAPE [x1 y1 x2 y2 x3 y3 ...]</term>
          <listitem>
            <para> 
                Contorno del mapa en coordenadas.
            </para>
            <para> Un borde arbitrario de un polígono para ser usado con fines de consultas.
					Multiples instancias simplemente agregan trozos al borde, por lo que es posible construir un 
					poligono con agujeros. Utilizado con los modos NQUERY y NQUERYMAP.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>MAPXY [x] [y]</term>
          <listitem>
            <para> 
				un punto, en el mismo sistema de coordenadas que los archivos
              	shape, para ser utilizados en conjunto con un buffer o una
				escala específica para contruir una extención del mapa. 
			</para>
            <para>
                Puede ser fijado con un <emphasis>shape</emphasis> como una opción
				alternativa. En este caso el mapextent (entención del mapa) es fijado 
				a la extensión del shape seleccionado. Utilizado con consultas.
            </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>MINX|MINY|MAXX|MAXY [número]</term>
          <listitem>
            <para> Coordenada x minima de la extensión espacial para un nuevo mapa/consulta.
			</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>MODE [valor]</term>
          <listitem>
            <para> Modo de operación. Las siguientes opciones están
              soportadas: (note que todos los modos de consulta también soportan modos de sólo-mapas
              (map-only modes), v.gr.e.g. ITEMQUERYMAP, que actualmente no están todos listados):</para>
            <variablelist>
              <varlistentry>
                <term>BROWSE</term>
                <listitem>
                  <para> 
				  	Interfaz donde son creados mapas (y las páginas) interactivos. 
					Este es el modo por defecto.
				  </para>
                </listitem>
              </varlistentry>
              <varlistentry>
                <term>QUERY</term>
                <listitem>
                  <para> Una búsqueda espacial (encuentra los más cercanos??)(finds closest) es lanzado
                    por un click sobre el mapa.</para>
                </listitem>
              </varlistentry>
              <varlistentry>
                <term>NQUERY</term>
                <listitem>
                  <para> Una búsqueda espacial (encuentra todos) es lanzada
                    por un click sobre el mapa o por un recuadro definido por el usuario.</para>
                </listitem>
              </varlistentry>
              <varlistentry>
                <term>ITEMQUERY</term>
                <listitem>
                  <para> Una búzqueda de texto en los atributos de las bases de datos es lanzada
                    usando un layer FILTER.  Retorna la primera coincidencia.</para>
                </listitem>
              </varlistentry>
              <varlistentry>
                <term>ITEMNQUERY</term>
                <listitem>
                  <para> Una búzqueda de texto en los atributos de las bases de datos es lanzada
                    usando un layer FILTER.  Retorna todas las coincidencias.</para>
                </listitem>
              </varlistentry>
              <varlistentry>
                <term>INDEXQUERY</term>
                <listitem>
                  <para> busca una característica basada en los valores de los parametros de 
                    SHAPEINDEX y TILEINDEX. El SHAPEINDEX is
                    requerido, el TILEINDEX es opcional y sólo es utilizado en layers
                    con archivos shape encuadrados (tiled shapefiles). </para>
                </listitem>
              </varlistentry>
              <varlistentry>
                <term>FEATUREQUERY</term>
                <listitem>
                  <para> Una búsqueda espacial que utiliza una característica proveniente
                    de SLAYER para consultar otros layers.</para>
                </listitem>
              </varlistentry>
              <varlistentry>
                <term>FEATURENQUERY</term>
                <listitem>
                  <para> Una búsqueda espacial que utiliza múltiples características provenientes
                    de SLAYER para consultar otros layers.</para>
                </listitem>
              </varlistentry>
              <varlistentry>
                <term>FEATUREITEMQUERY</term>
                <listitem>
                  <para> Una búzqueda de texto en los atributos de las bases de datos es lanzada
                    usando un layer FILTER. Retorna la primera coincidencia. El Layer en que se realizará
					la búsqueda está definido utilizando el parámetro SLAYER. Los resultados
                    de esta búsqueda son aplicados a otros layer en que tambien se realicen búsquedas (que puede ser limitado usando
					el parámetro QLAYER).</para>
                </listitem>
              </varlistentry>
              <varlistentry>
                <term>FEATUREITEMNQUERY</term>
                <listitem>
                  <para> Una búzqueda de texto en los atributos de las bases de datos es lanzada
                    usando un layer FILTER. Retorna todas las coincidencias. El Layer en que se realizará
					la búsqueda está definido utilizando el parámetro SLAYER. Los resultados
                    de esta búsqueda son aplicados a otros layer en que tambien se realicen búsquedas (que puede ser limitado usando
					el parámetro QLAYER).</para>
                </listitem>
              </varlistentry>
              <varlistentry>
                <term>MAP</term>
                <listitem>
                  <para> El mapa creado que es enviado al cliente. Utilizado dentro de una etiqueta html 
                    &lt;img ... &gt; .     </para>
                </listitem>
              </varlistentry>
              <varlistentry>
                <term>REFERENCE</term>
                <listitem>
                  <para> El mapa de referencia (esquicio) creado que es enviado al cliente. Utilizado dentro de una etiqueta html 
                    &lt;img ... &gt; .   </para>
                </listitem>
              </varlistentry>
              <varlistentry>
                <term>SCALEBAR</term>
                <listitem>
                  <para> La escala gráfica creada que es enviada al cliente. Utilizado dentro de una etiqueta html 
                    &lt;img ... &gt; .</para>
                </listitem>
              </varlistentry>
              <varlistentry>
                <term>LEGEND</term>
                <listitem>
                  <para> La leyenda creada que es enviada al cliente. Utilizado dentro de una etiqueta html 
                    &lt;img ... &gt; .    </para>
                </listitem>
              </varlistentry>
            </variablelist>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>QLAYER [nombre]</term>
          <listitem>
            <para> Laayer de consulta. El nombre del layer que será consultado tal como aparece en el <ulink url="mapfile-reference.html">map
              file</ulink>. Si no se especifica un nombre, entoces todos los layers seran consultados uno por uno (searched in turn).</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>QUERYFILE [nombre-de-archivo]</term>
          <listitem>
            <para> Usado con los modos BROWSE o NQUERY. Esta opción
              identifica una archivo de consulta para cargarlo antes que calquier
			  preceso regular. En el modo BROWSE esto da como resultado un mapa de consulta,
              producido en lugar de un mapa regular. Esto es muy utilizado
              cuando se quiere resaltar una característica (dato) mientras estas en el modo mover/acercar de la interface web.
			  En el modo NQUERY se puede tener ecceso a cualquier plantilla usada normalmente para presentar los resultados de las consulta,
			  dando tambien acceso a los mapas de consulta e informacion de los stributosde las bases de datos. Para más informaci{on,
			  vea la opcion SAVEQUERY.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>REF</term>
          <listitem>
            <para> El nombre asociado con la imagen del mapa de referencia (esquicio)
              usado para registrar clicks del usuario, que son almacenados en dos variables: ref.x y ref.y.
			  </para>
          </listitem>
        </varlistentry>
	    <varlistentry>
            <term>REFXY [x] [y]</term>
            <listitem>
                <para> 
                    Coordenadas (en pixeles) de un click del mouse sobre la imagenn del mapa de referencia. 
                    Usado en conjunto con unterfaces web basadas en Java, en conjunto con MapServer.
	            </para>
            </listitem>
        </varlistentry>
	    <varlistentry>
            <term>SAVEMAP</term>
            <listitem>
               <para> 
				Guarda las opciones del mapa en un nuevo mapfile en el directorio temporal previamente
				especicado (<ulink url="mapfile-reference.html#web">imagepath (ruta de la imagen)</ulink>). EL archivo puede 
				ser referido con la etiqueta [map] en el <ulink url="template-reference.html">archivo plantilla</ulink>.
				Note que las rutas especificadas en el mapfile son relativas a la ubicación de este.
	                </para>
                </listitem>
            </varlistentry>
        <varlistentry>
          <term>SAVEQUERY</term>
          <listitem>
            <para> Cuando se usa cualquier modo de consulta, mapserver recibe la intrucción de
              guardar los resultados de las consultas en un archivo temporal, para su uso en operaciones subsecuentes
              (vea QUERYFILE). Muy utilizado para realizar consultas persistentes.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>SCALE [número]</term>
          <listitem>
            <para> Escala con la cual crear un nuevo mapa. Usado con mapxy. La escala
              es dada como el denominador de la fracción de escala actual,
              por ejemplo, para un mapa con una escala de 1:24,000; use 24000.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>SEARCHMAP</term>
          <listitem>
            <para> Es posible cosntruir interfaces para moverse y hacer zoom usando
              mapas de consulta (querymaps). En casos donde se requiriera información
              sobre los contenidos del mapa nuevo en vez de los del mapa anterior,
			  que es lamanera normal de trabajo de las consultas. Cuando una mapa de búsqueda (searchmap)
              es especificado, el nuevo mapa es creado y su extensión (extent) es
              usada para consultar los layers. Utilizado sólo en el modo NQUERY.</para>
          </listitem>
        </varlistentry>
	    <varlistentry>
            <term>SHAPEINDEX [índice]</term>
	        <listitem>
                <para> 
                    Utilizado para consultas con índice. 
					(en conjunto con INDEXQUERY).
	            </para>
            </listitem>
        </varlistentry>
	
        <varlistentry>
          <term>SLAYER [nombre]</term>
          <listitem>
            <para> Selecciona un layer. El Nombre de un layer que será utilizado con
              cualquier modo de consulta (v.gr. caminos). El layer seleccionado <emphasis>debe ser</emphasis> de tipo poligono. 
			  Las Características de selección están disponibles para presentarlas al usuario.</para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>TEMPLATE [nombre de archivo]</term>
          <listitem>
            <para> Nonbre del archivo plantilla principal utilizado para dar forma a los resultados.
			 Se superpone a cualquier otra configuración (en la sección WEB) en el mapfile.</para>
          </listitem>
        </varlistentry>
	        <varlistentry>
                <term>TILEINDEX [índice]</term>
	            <listitem>
                    <para> 
						Utilizado para índices de las consultas (en conjunto con INDEXQUERY), cuando se emplean shapes seccionados (tiled Shapefiles).
	                </para>
                </listitem>
            </varlistentry>
	
<!-- Comment by Steve Lime: Not used in version 3.5
	        <varlistentry>
                <term>VALUE [expression]</term>
                <listitem>
                    <para> 
                        Value (regular expression) to match 
	                    against in item/value lookups.
	                </para>
                </listitem>
            </varlistentry>
-->	
        <varlistentry>
          <term>ZOOM [número]</term>
          <listitem>
            <para> Factor de zoom applicado en la creación de un nuevo mapa.
              Valores mayores a 0 resultan en zoom de acercamiento, 0 en un pan (moverse),
              y valores menores a cero en un zoom de alejamiento. Un valor de 
              2 significa una vista al doble de tamaño.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>ZOOMDIR [1|0|-1]</term>
          <listitem>
            <para> Dirección del zoom. Ver más abajo.    </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term>ZOOMSIZE [número]</term>
          <listitem>
            <para> Valor Absoluto (magnitud)del zoom. Usado con ZOOMDIR.</para>
          </listitem>
        </varlistentry>
      </variablelist>
    </sect2>

	<!-- mapfile changes -->
    <sect2 id="mapfile">
      <title>Cambiar los parámetros del <ulink url="mapfile-reference.html">map
        file</ulink> a travéz de un formulario web o una URL</title>
      <para>Desde la versión 3.3 de mapserver es posible cambiar virtualmente
	   cualquier value contenido en el mapfile delde un formulario o una URL. La sintaxis
	    para esto es bastante sencilla. Cualquier valor puede ser expresado
        usando la jerarquia utilizada en el mapfile. Un mapa contiene un layer,
        el cual contiene una clase (class), la cual contiene una etiqueta (label), la que a su vez contiene un
        color. Esta jerarquía está expresada com una secuancia de palabras reservadas (keyword) de MapServer
        separadas por underscores( _ ). Por Ejemplo, para cambiar el
		color de un layer llamado &quot;lagos&quot; con sólo una clase definida
        podrías usar una variable de formulario web llamada
        &quot;map_lagos_class_color&quot; y podrías asignar un color
        como &quot;0 0 255&quot;. Los layers pueden ser referenciados por índices
        (i.e. map_layer_0...) o por su nombre como se muestra más adelante. Las clases del layer
        son referenciadas por el valor de su índice(v.gr.  map_layer_0_class_2). Si
        sólo hay una clase para el layer, entonces el índice será omitido.
        Estas variables siembre deben comenzar con la secuencia
        &quot;map_&quot;. Los valores asignados deben estar conforme a la sintaxis del mapfile.</para>
      <para>Tambien es posible definir algunas características en línea usando este mismo mecanismo. 
	    Esto es sólo en el caso donde quieras agregar o cambiar algo al mapfile.  
		Puedes editar/cambiar parámetros de los layers pero no puedes crear uno nuevo. 
		Con estas características en línea (inline features) primero debes crear y caracterizar y luego variar sobre lo construido,
		sin ambargo, las caracteristicas del layer deben existir previamente (definidas en al mapfile).
		Aquí hay una muestra de una petición GET que agrega una característica al layer webuser :
        <programlisting><![CDATA[
      ...&map_webuser_feature=new&map_webuser_feature_points=12345.6789+12345.6789
         +map_webuser_feature_text=My+House!&...
      ]]></programlisting>
        El parámetro &quot;map_webuser_feature=new&quot; crea una nueva característica
        para el layer webuser. Todas las llamadas sunsecuentes a las características del objeto
        para ese layer serán modificadas con las nuevas características. Tu puedes repetir
        el proceso para crear caracterñisticas adicionales. Esto es recomendado para porciones
        de datos realmente pequeños (puntos, rectangulos).
		</para>
       <para>Es perfectamente posible que tengamos algunos atajos para este proceso,
	    pero mientras sepamos cuan util es esto para nuestros usuarios.
		Un uso potencial involucra cambiar las expresiones de las clases al vuelo. 
		De todas mnaneras, Pruebenlo, les va a encantar.</para>
    </sect2>

<!--
	<sect2 id="experimental">
		<title>Experimental</title>
		<variablelist>
        	<varlistentry>
            	<term>EGIS {none}</term>
            	<listitem>
                	<para>
                    	OV - eGIS - additional token "none" is defined to 
                    	create somewhat mutual exculsiveness between 
                    	mapserver and eGIS.
     	           </para>
        	        <para>
            	        This parameter is only available if Mapserv was 
                	    built with the <emphasis>USE_EGIS</emphasis> flag.
             	   </para>
           	 	</listitem>
        	</varlistentry>
		</variablelist>
	</sect2>
-->
  </sect1>
</article>
