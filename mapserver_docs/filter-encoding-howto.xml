<?xml version="1.0" standalone="no"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.1.2//EN"
          "http://mapserver.gis.umn.edu/mdp/docbkx412/docbookx.dtd">
<article>
  <articleinfo>
    <title>             MapServer Filter Encoding (FE) HOWTO - Version 4.4</title>
    <author>
      <firstname>       Yewondwossen </firstname>
      <surname>         Assefa</surname>
      <affiliation>
        <orgname>       DM Solutions Group Inc.</orgname>
        <address>
                 <email>assefa@dmsolutions.ca</email>
        </address>
      </affiliation>
    </author>
    <author>
      <firstname>Jeff</firstname>
      <surname>McKenna</surname>
      <affiliation>
        <orgname>DM Solutions Group Inc.</orgname>
        <address>
          <email>jmckenna@dmsolutions.ca</email>
        </address>
      </affiliation>
    </author>     
    <abstract>
      <para>
                        This document describes the procedures for taking advantage of the Filter Encoding (FE) support in WFS GetFeature requests that has been added to MapServer 4.2.                     
      </para>  
      <para>            
                        Last Updated: 2005-01-09
      </para>
      <para>
          <link linkend="rhistory">Revision History</link>
      </para>      
    </abstract>
  </articleinfo>
  <sect1 id="intro">
    <title>             Introduction</title>
    <blockquote><attribution>Filter Encoding Implementation Specification, OGC</attribution>
      <para>
                        &quot;A filter expression is a construct used to constraints the property values of an object type for the purpose of identifying a subset of object instances to be operated upon in some manner...For example, a web feature service may use the XML filter encoding in a GetFeature operation to define query constraints.&quot;   
      </para>
    </blockquote>  
    <para>
                        This document assumes that you are already familiar with the following aspects of MapServer:
    </para>
      <itemizedlist>
        <listitem>
          <para>
                        MapServer application development and setting up <filename>.map</filename> files. 
          </para>
        </listitem>
        <listitem>
          <para>
                        Familiarity with the WFS specification would be an asset. A link to the WFS specification document is included in the <link linkend="links">Links to FE-Related Information</link> section below.
          </para>
        </listitem>
      </itemizedlist>
      <sect2 id="links">
        <title>         Links to FE-related Information</title>
        <itemizedlist>
          <listitem>
            <para>
                        <emphasis>Filter Encoding Implementation Specification</emphasis> at <ulink url="http://www.opengeospatial.org/docs/02-059.pdf">http://www.opengeospatial.org/docs/02-059.pdf</ulink>.
            </para>
          </listitem>
          <listitem>
            <para>
                        Open GIS Consortium (OGC) home page at <ulink url="http://www.opengeospatial.org/">http://www.opengeospatial.org/</ulink>.
            </para>
          </listitem>
          <listitem>
            <para>
                        <emphasis>MapServer WFS Server HOWTO</emphasis> at <ulink url="http://mapserver.gis.umn.edu/doc/wfs-server-howto.html">http://mapserver.gis.umn.edu/doc/wfs-server-howto.html</ulink>.
            </para>
          </listitem>
        </itemizedlist>
     </sect2>
  </sect1>  
  <sect1 id="supported">
    <title>             Currently Supported Features</title>
    <para>
                        The following table lists the currently supported features for FE. 
    </para>                    
    <table frame='all'><title>Currently Supported Features</title>
      <tgroup cols='2' align='left' colsep='1' rowsep='1'>
        <colspec colname='c1'/>
        <colspec colname='c2'/>
        <thead>
          <row>
            <entry align="center">Feature Set</entry>
            <entry align="center">Feature</entry>
          </row>
        </thead>
        <tbody>
          <row>
            <entry>Spatial Capabilities</entry>
            <entry>BBox</entry>
          </row>
          <row>
            <entry> </entry>
            <entry>Intersects</entry>
          </row> 
          <row>
            <entry> </entry>
            <entry>DWithin</entry>
          </row>           
          <row>
            <entry> </entry>
            <entry> </entry>
          </row>
          <row>
            <entry>Scalar Capabilities</entry>
            <entry> </entry>
          </row>
          <row>
            <entry> </entry>
            <entry> </entry>
          </row>
          <row>
            <entry>Logical Operators</entry>
            <entry>And</entry>
          </row>
          <row>
            <entry> </entry>
            <entry>Or</entry>
          </row>
          <row>
            <entry> </entry>
            <entry>Not</entry>
          </row>
          <row>
            <entry> </entry>
            <entry> </entry>
          </row>
          <row>
            <entry>Comparison Operators</entry>
            <entry>PropertyIsEqualTo (=)</entry>
          </row>
          <row>
            <entry> </entry>
            <entry>PropertyIsNotEqualTo (&lt;&gt;)</entry>
          </row>
          <row>
            <entry> </entry>
            <entry>PropertyIsLessThan (&lt;)</entry>
          </row>
          <row>
            <entry> </entry>
            <entry>PropertyIsGreaterThan (&gt;)</entry>
          </row>
          <row>
            <entry> </entry>
            <entry>PropertyIsLessThanOrEqualTo (&lt;=)</entry>
          </row>
          <row>
            <entry> </entry>
            <entry>PropertyIsGreaterThanOrEqualTo (&gt;=)</entry>
          </row>
          <row>
            <entry> </entry>
            <entry>PropertyIsLike</entry>
          </row>
          <row>
            <entry> </entry>
            <entry>PropertyIsBetween (range)</entry>
          </row>
        </tbody>
      </tgroup>
    </table>    
  </sect1>  
  <sect1 id="getpost">
    <title>             Get and Post Requests</title>
    <para>
                        MapServer already has the capability to receive and parse Get requests and URL-encoded Post requests. The ability for MapServer to be able to receive Post requests with XML-encoded information sent in the body of the request has been added. Also, the ability to generate XML-encoded Post requests for WFS layers has been added.
    </para>
    <para>
                        Both Get and Post request are now supported for all WFS requests:
    </para>
    <itemizedlist>
      <listitem>
        <para>
                        GetCapabilities
        </para>
      </listitem>
      <listitem>
        <para>
                        GetFeatures
        </para>
      </listitem>
      <listitem>
        <para>
                        DescribeFeatureType
        </para>
      </listitem>
    </itemizedlist>
    <para>
                        Supporting these WFS requests in Post was implemented to keep consistency between all supported WFS requests. 
    </para>
    <para>
                        When sending requests,  the default request method used is Post. To change this behavior, we have introduced a layer level meta data, <varname>wfs_request_method</varname>, which can be set to &quot;<varname>GET</varname>&quot;.
    </para>
  </sect1>  
  <sect1 id="usefe">
    <title>             Use of Filter Encoding in MapServer</title>
    <para>
                        This section describes how to use FE on both the server and client sides.
    </para>                    
    <sect2 id="server">
      <title>           Server Side</title>
      <para>
                        To be able to use Filter Encoding, you need to create a valid WFS server using MapServer. Please refer to the <ulink url="http://mapserver.gis.umn.edu/doc40/wfs-server-howto.html">WFS HowTo</ulink> for specifics.
      </para>
      <para>
                        There is nothing special that should be added to a WFS server for Filter Encoding, but you should note that, when requesting the capabilities of your WFS server, the document returned should contain the supported filters. Here is part of a Capabilities document as well as the Post support:
      </para>
      <programlisting>
&lt;?xml version='1.0' encoding=&quot;ISO-8859-1&quot; ?&gt;
&lt;WFS_Capabilities 
   version=&quot;1.0.0&quot; 
   updateSequence=&quot;0&quot; 
   xmlns=&quot;http://www.opengis.net/wfs&quot; 
   xmlns:ogc=&quot;http://www.opengis.net/ogc&quot; 
   xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
   xsi:schemaLocation=&quot;http://www.opengis.net/wfs http://ogc.dmsolutions.ca/wfs/1.0.0/WFS-capabilities.xsd&quot;&gt;

&lt;!-- MapServer version 4.1 OUTPUT=GIF OUTPUT=PNG OUTPUT=JPEG OUTPUT=WBMP 
OUTPUT=PDF OUTPUT=SWF SUPPORTS=PROJ SUPPORTS=FREETYPE SUPPORTS=WMS_SERVER 
SUPPORTS=WMS_CLIENT SUPPORTS=WFS_SERVER SUPPORTS=WFS_CLIENT INPUT=POSTGIS 
INPUT=OGR INPUT=GDAL INPUT=SHAPEFILE --&gt;

&lt;Service&gt;
  &lt;Name&gt;MapServer WFS&lt;/Name&gt;
  &lt;Title&gt;GMap WMS Demo Server&lt;/Title&gt;
  &lt;OnlineResource&gt;http://localhost/cgi-bin/mapserv.exe?map=
    c:/msapps/wfs_filter/htdocs/ns_wfsserver.map&amp;&lt;/OnlineResource&gt;
&lt;/Service&gt;

&lt;Capability&gt;
  &lt;Request&gt;
    &lt;GetCapabilities&gt;
      &lt;DCPType&gt;
        &lt;HTTP&gt;
          &lt;Get onlineResource=&quot;http://localhost/cgi-bin/mapserv.exe?map=
            c:/msapps/wfs_filter/htdocs/ns_wfsserver.map&amp;&quot; /&gt;
        &lt;/HTTP&gt;
      &lt;/DCPType&gt;
      &lt;DCPType&gt;
        &lt;HTTP&gt;
          &lt;Post onlineResource=&quot;http://localhost/cgi-bin/mapserv.exe?map=
            c:/msapps/wfs_filter/htdocs/ns_wfsserver.map&amp;&quot; /&gt;
        &lt;/HTTP&gt;
      &lt;/DCPType&gt;
    &lt;/GetCapabilities&gt;
    ...
  &lt;/Request&gt;
&lt;/Capability&gt;
...
&lt;Filter_Capabilities&gt;
  &lt;Spatial_Capabilities&gt;
    &lt;Spatial_Operators&gt;
             &lt;Intersect/&gt;
             &lt;DWithin/&gt;
           &lt;BBOX/&gt;
    &lt;/Spatial_Operators&gt;
  &lt;/Spatial_Capabilities&gt;
  &lt;Scalar_Capabilities&gt;
    &lt;Logical_Operators /&gt;
    &lt;Comparison_Operators&gt;
      &lt;Simple_Comparisons /&gt;
      &lt;Like /&gt;
      &lt;Between /&gt;
    &lt;/Comparison_Operators&gt;
  &lt;/Scalar_Capabilities&gt;
&lt;/Filter_Capabilities&gt;

&lt;/WFS_Capabilities&gt;
      </programlisting>
    </sect2>
    <sect2 id="client">
      <title>Client Side</title>
      <para>
                        To be able to generate a Filter to a WFS server, a layer level metadata called <varname>wfs_filter</varname> has been added, which should contain the filter to be sent to the server.  Following is an example of a valid WFS client layer with a filter:
      </para>
      <programlisting>
LAYER
  NAME popplace
  METADATA
    &quot;wfs_filter&quot; &quot;&lt;PropertyIsGreaterThan&gt;&lt;PropertyName&gt;POP_RANGE&lt;/PropertyName&gt;&lt;Literal&gt;4
      &lt;/Literal&gt;&lt;/PropertyIsGreaterThan&gt;&quot;

  END

  TYPE POINT
  STATUS ON

  PROJECTION
    &quot;init=epsg:42304&quot;
  END

  CONNECTIONTYPE WFS
  CONNECTION &quot;http://www2.dmsolutions.ca:8090/cgi-bin/mswfs_filter?SERVICE=WFS&amp;VERSION=1.0.0
    &amp;TYPENAME=popplace&quot;

  LabelItem &quot;Name&quot;  
# LabelItem &quot;Pop_range&quot;  
  CLASSITEM &quot;Capital&quot; 
  CLASS
    
    TEMPLATE &quot;ttt_query.html&quot;
    SYMBOL 2
    SIZE 8

    NAME &quot;Cities&quot;
    LABEL
      COLOR  255 0 0
      FONT fritqat-italic
      TYPE truetype
      SIZE 8
      POSITION AUTO         
      #PARTIALS FALSE
      OUTLINECOLOR 255 255 255  
      FORCE TRUE
        
    END 
    COLOR 0 0 0
  END
  
  TOLERANCE 5
END # Layer
      </programlisting>
      <note>
      <itemizedlist>
        <listitem>
          <para>
                        The filter given as a value of the <varname>wfs_filter</varname> metadata should not contain <varname>&lt;Filter&gt;</varname> start and end tags.
          </para>
        </listitem>
        <listitem>
          <para>
                        The <varname>CONNECTION</varname> points to a valid WFS server supporting filters
          </para>
        </listitem>
        <listitem>
          <para>
                        The returned shapes will be drawn using the class defined in the layer.
          </para>
        </listitem>
      </itemizedlist>
      </note>
    </sect2>     
  </sect1>  
  <sect1 id="limits">
    <title>             Limitations</title>
    <itemizedlist>
      <listitem>
        <para>
          A limited set of spatial operators are supported.
        </para>
      </listitem>  
    </itemizedlist>   
  </sect1>
  <sect1 id="tests">
    <title>             Tests</title>
    <itemizedlist>
      <listitem>
        <para>
          Here are some test URLs for the different Filters supported:
        </para>
        <itemizedlist>
          <listitem>
            <para>
              <emphasis>PropertyIsEqualTo</emphasis>: <ulink url="http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;PropertyIsEqualTo&gt;&lt;PropertyName&gt;NAME&lt;/PropertyName&gt;&lt;Literal&gt;Digby&lt;/Literal&gt;&lt;/PropertyIsEqualTo&gt;&lt;/Filter&gt;">
              http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;PropertyIsEqualTo&gt;&lt;PropertyName&gt;NAME&lt;/PropertyName&gt;&lt;Literal&gt;Digby&lt;/Literal&gt;&lt;/PropertyIsEqualTo&gt;&lt;/Filter&gt;</ulink>
            </para>
          </listitem>
          <listitem>
            <para>
              <emphasis>PropertyIsNotEqualTo</emphasis>: <ulink url="http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;PropertyIsNotEqualTo&gt;&lt;PropertyName&gt;NAME&lt;/PropertyName&gt;&lt;Literal&gt;Digby&lt;/Literal&gt;&lt;/PropertyIsNotEqualTo&gt;&lt;/Filter&gt;">
              http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;PropertyIsNotEqualTo&gt;&lt;PropertyName&gt;NAME&lt;/PropertyName&gt;&lt;Literal&gt;Digby&lt;/Literal&gt;&lt;/PropertyIsNotEqualTo&gt;&lt;/Filter&gt;</ulink>
            </para>
          </listitem> 
          <listitem>
            <para>
              <emphasis>PropertyIsLessThan</emphasis>: <ulink url="http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;PropertyIsLessThan&gt;&lt;PropertyName&gt;POP_RANGE&lt;/PropertyName&gt;&lt;Literal&gt;2&lt;/Literal&gt;&lt;/PropertyIsLessThan&gt;&lt;/Filter&gt;">
              http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;PropertyIsLessThan&gt;&lt;PropertyName&gt;POP_RANGE&lt;/PropertyName&gt;&lt;Literal&gt;2&lt;/Literal&gt;&lt;/PropertyIsLessThan&gt;&lt;/Filter&gt;</ulink>
            </para>
          </listitem>  
          <listitem>
            <para>
              <emphasis>PropertyIsGreaterThan</emphasis>: <ulink url="http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;PropertyIsGreaterThan&gt;&lt;PropertyName&gt;POP_RANGE&lt;/PropertyName&gt;&lt;Literal&gt;5&lt;/Literal&gt;&lt;/PropertyIsGreaterThan&gt;&lt;/Filter&gt;">
              http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;PropertyIsGreaterThan&gt;&lt;PropertyName&gt;POP_RANGE&lt;/PropertyName&gt;&lt;Literal&gt;5&lt;/Literal&gt;&lt;/PropertyIsGreaterThan&gt;&lt;/Filter&gt;</ulink>
            </para>
          </listitem>  
          <listitem>
            <para>
              <emphasis>PropertyIsLessThanOrEqualTo</emphasis>: <ulink url="http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;PropertyIsLessThanOrEqualTo&gt;&lt;PropertyName&gt;POP_RANGE&lt;/PropertyName&gt;&lt;Literal&gt;2&lt;/Literal&gt;&lt;/PropertyIsLessThanOrEqualTo&gt;&lt;/Filter&gt;">
              http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;PropertyIsLessThanOrEqualTo&gt;&lt;PropertyName&gt;POP_RANGE&lt;/PropertyName&gt;&lt;Literal&gt;2&lt;/Literal&gt;&lt;/PropertyIsLessThanOrEqualTo&gt;&lt;/Filter&gt;</ulink>
            </para>
          </listitem> 
          <listitem>
            <para>
              <emphasis>PropertyIsGreaterThanOrEqualTo</emphasis>: <ulink url="http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;PropertyIsGreaterThanOrEqualTo&gt;&lt;PropertyName&gt;POP_RANGE&lt;/PropertyName&gt;&lt;Literal&gt;5&lt;/Literal&gt;&lt;/PropertyIsGreaterThanOrEqualTo&gt;&lt;/Filter&gt;">
              http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;PropertyIsGreaterThanOrEqualTo&gt;&lt;PropertyName&gt;POP_RANGE&lt;/PropertyName&gt;&lt;Literal&gt;5&lt;/Literal&gt;&lt;/PropertyIsGreaterThanOrEqualTo&gt;&lt;/Filter&gt;</ulink>
            </para>
          </listitem>  
          <listitem>
            <para>
              <emphasis>PropertyIsBetween</emphasis>: <ulink url="http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;PropertyIsBetween&gt;&lt;PropertyName&gt;POP_RANGE&lt;/PropertyName&gt;&lt;LowerBoundary&gt;5&lt;/LowerBoundary&gt;&lt;UpperBoundary&gt;6&lt;/UpperBoundary&gt;&lt;/PropertyIsBetween&gt;&lt;/Filter&gt;">
              http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;PropertyIsBetween&gt;&lt;PropertyName&gt;POP_RANGE&lt;/PropertyName&gt;&lt;LowerBoundary&gt;5&lt;/LowerBoundary&gt;&lt;UpperBoundary&gt;6&lt;/UpperBoundary&gt;&lt;/PropertyIsBetween&gt;&lt;/Filter&gt;</ulink>
           </para>
          </listitem>  
          <listitem>
            <para>
              <emphasis>PropertyIsLike</emphasis>: <ulink url="http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;PropertyIsLike wildcard='*' singleChar='.' escape='!'&gt;&lt;PropertyName&gt;NAME&lt;/PropertyName&gt;&lt;Literal&gt;Syd*&lt;/Literal&gt;&lt;/PropertyIsLike&gt;&lt;/Filter&gt;">
              http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;PropertyIsLike wildcard='*' singleChar='.' escape='!'&gt;&lt;PropertyName&gt;NAME&lt;/PropertyName&gt;&lt;Literal&gt;Syd*&lt;/Literal&gt;&lt;/PropertyIsLike&gt;&lt;/Filter&gt;</ulink>
           </para>
          </listitem> 
          <listitem>
            <para>
              <emphasis>Logical operator OR</emphasis>: <ulink url="http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;OR&gt;&lt;PropertyIsEqualTo&gt;&lt;PropertyName&gt;NAME&lt;/PropertyName&gt;&lt;Literal&gt;Sydney&lt;/Literal&gt;&lt;/PropertyIsEqualTo&gt;&lt;PropertyIsEqualTo&gt;&lt;PropertyName&gt;NAME&lt;/PropertyName&gt;&lt;Literal&gt;Digby&lt;/Literal&gt;&lt;/PropertyIsEqualTo&gt;&lt;/OR&gt;&lt;/Filter&gt;">
              http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;OR&gt;&lt;PropertyIsEqualTo&gt;&lt;PropertyName&gt;NAME&lt;/PropertyName&gt;&lt;Literal&gt;Sydney&lt;/Literal&gt;&lt;/PropertyIsEqualTo&gt;&lt;PropertyIsEqualTo&gt;&lt;PropertyName&gt;NAME&lt;/PropertyName&gt;&lt;Literal&gt;Digby&lt;/Literal&gt;&lt;/PropertyIsEqualTo&gt;&lt;/OR&gt;&lt;/Filter&gt;</ulink>
           </para>
          </listitem> 
          <listitem>
            <para>
              <emphasis>Logical operator AND</emphasis>: <ulink url="http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;AND&gt;&lt;PropertyIsLike wildcard='*' singleChar='.' escape='!'&gt;&lt;PropertyName&gt;NAME&lt;/PropertyName&gt;&lt;Literal&gt;Syd*&lt;/Literal&gt;&lt;/PropertyIsLike&gt;&lt;PropertyIsEqualTo&gt;&lt;PropertyName&gt;POP_RANGE&lt;/PropertyName&gt;&lt;Literal&gt;4&lt;/Literal&gt;&lt;/PropertyIsEqualTo&gt;&lt;/AND&gt;&lt;/Filter&gt;">
              http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;AND&gt;&lt;PropertyIsLike wildcard='*' singleChar='.' escape='!'&gt;&lt;PropertyName&gt;NAME&lt;/PropertyName&gt;&lt;Literal&gt;Syd*&lt;/Literal&gt;&lt;/PropertyIsLike&gt;&lt;PropertyIsEqualTo&gt;&lt;PropertyName&gt;POP_RANGE&lt;/PropertyName&gt;&lt;Literal&gt;4&lt;/Literal&gt;&lt;/PropertyIsEqualTo&gt;&lt;/AND&gt;&lt;/Filter&gt;</ulink>
           </para>
          </listitem>  
          <listitem>
            <para>
              <emphasis>Logical operator NOT</emphasis>: <ulink url="http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;AND&gt;&lt;NOT&gt;&lt;PropertyIsEqualTo&gt; &lt;PropertyName&gt;POP_RANGE&lt;/PropertyName&gt;&lt;Literal&gt;2&lt;/Literal&gt;&lt;/PropertyIsEqualTo&gt;&lt;/NOT&gt;&lt;NOT&gt;&lt;PropertyIsEqualTo&gt;&lt;PropertyName&gt;POP_RANGE&lt;/PropertyName&gt;&lt;Literal&gt;3&lt;/Literal&gt;&lt;/PropertyIsEqualTo&gt;&lt;/NOT&gt;&lt;/AND&gt;&lt;/Filter&gt;">
              http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;AND&gt;&lt;NOT&gt;&lt;PropertyIsEqualTo&gt; &lt;PropertyName&gt;POP_RANGE&lt;/PropertyName&gt;&lt;Literal&gt;2&lt;/Literal&gt;&lt;/PropertyIsEqualTo&gt;&lt;/NOT&gt;&lt;NOT&gt;&lt;PropertyIsEqualTo&gt;&lt;PropertyName&gt;POP_RANGE&lt;/PropertyName&gt;&lt;Literal&gt;3&lt;/Literal&gt;&lt;/PropertyIsEqualTo&gt;&lt;/NOT&gt;&lt;/AND&gt;&lt;/Filter&gt;</ulink>
           </para>
          </listitem> 
          <listitem>
            <para>
              <emphasis>Spatial operator BBOX</emphasis>: <ulink url="http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;BBOX&gt;&lt;PropertyName&gt;Name&gt;NAME&lt;/PropertyName&gt;&lt;Box srsName='EPSG:42304'&gt;&lt;coordinates&gt;2518000,150000 2918000,450000&lt;/coordinates&gt;&lt;/Box&gt;&lt;/BBOX&gt;&lt;/Filter&gt;">
              http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;BBOX&gt;&lt;PropertyName&gt;Name&gt;NAME&lt;/PropertyName&gt;&lt;Box srsName='EPSG:42304'&gt;&lt;coordinates&gt;2518000,150000 2918000,450000&lt;/coordinates&gt;&lt;/Box&gt;&lt;/BBOX&gt;&lt;/Filter&gt;</ulink>
           </para>
          </listitem> 
          <listitem>
            <para>
              <emphasis>Spatial operator Dwithin</emphasis>: <ulink url="http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;DWithin&gt;&lt;PropertyName&gt;Geometry&lt;/PropertyName&gt;&lt;gml:Point&gt;&lt;gml:coordinates&gt;2587598.000000,404010.531250&lt;/gml:coordinates&gt;&lt;/gml:Point&gt;&lt;Distance units='m'&gt;1000&lt;/Distance&gt;&lt;/DWithin&gt;&lt;/Filter&gt;">
              http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;DWithin&gt;&lt;PropertyName&gt;Geometry&lt;/PropertyName&gt;&lt;gml:Point&gt;&lt;gml:coordinates&gt;2587598.000000,404010.531250&lt;/gml:coordinates&gt;&lt;/gml:Point&gt;&lt;Distance units='m'&gt;1000&lt;/Distance&gt;&lt;/DWithin&gt;&lt;/Filter&gt;</ulink>
           </para>
          </listitem>  
          <listitem>
            <para>
              <emphasis>Spatial operator Intersects</emphasis>: <ulink url="http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;Intersect&gt;&lt;PropertyName&gt;Geometry&lt;/PropertyName&gt;&lt;gml:Polygon&gt;&lt;gml:outerBoundaryIs&gt;&lt;gml:LinearRing&gt;&lt;gml:coordinates&gt;2488789,289552 2588789,289552 2588789,389552 2488789,389552 2488789,289552&lt;/gml:coordinates&gt;&lt;/gml:LinearRing&gt;&lt;/gml:outerBoundaryIs&gt;&lt;/gml:Polygon&gt;&lt;/Intersect&gt;&lt;/Filter&gt;">
              http://www2.dmsolutions.ca/cgi-bin/mswfs_filter?&amp;VERSION=1.0.0&amp;SERVICE=WFS&amp;REQUEST=GetFeature&amp;TYPENAME=popplace&amp;Filter=&lt;Filter&gt;&lt;Intersect&gt;&lt;PropertyName&gt;Geometry&lt;/PropertyName&gt;&lt;gml:Polygon&gt;&lt;gml:outerBoundaryIs&gt;&lt;gml:LinearRing&gt;&lt;gml:coordinates&gt;2488789,289552 2588789,289552 2588789,389552 2488789,389552 2488789,289552&lt;/gml:coordinates&gt;&lt;/gml:LinearRing&gt;&lt;/gml:outerBoundaryIs&gt;&lt;/gml:Polygon&gt;&lt;/Intersect&gt;&lt;/Filter&gt;</ulink>
           </para>
          </listitem>          
        </itemizedlist>
      </listitem>
      <listitem>
        <para>
                        Tests using MapServer as a WFS client and a WFS server are available at <ulink url="http://www2.dmsolutions.ca/msapps/wfs_fe/">http://www2.dmsolutions.ca/msapps/wfs_fe/</ulink>.
        </para>
      </listitem>
      <listitem>
        <para>
                        The OGC conformance tests (<ulink url="http://cite.occamlab.com/tsOGC/">http://cite.occamlab.com/tsOGC/</ulink>) have been run on the FE support. The following table and notes reflect the current status. 
        </para>
    <table frame='all'><title>WFS OGC test suite (over the HTTP Get and Post method)</title>
      <tgroup cols='4' align='left' colsep='1' rowsep='1'>
        <colspec colname='c1'/>
        <colspec colname='c2'/>
        <colspec colname='c3'/>
        <colspec colname='c4'/>        
        <thead>
          <row>
            <entry align="center">#</entry>
            <entry align="center">Description</entry>
            <entry align="center"># of Tests</entry>   
            <entry align="center"># of Failed Tests</entry>               
          </row>
        </thead>
        <tbody>
          <row>
            <entry>1</entry>
            <entry>Basic WFS tests over the HTTP Get and Post method</entry>
            <entry>402</entry>
            <entry>281</entry>
          </row>     
          <row>
            <entry>1.1</entry>
            <entry>GetCapabilities</entry>
            <entry>16</entry>
            <entry>0</entry>
          </row>     
          <row>
            <entry>1.2</entry>
            <entry>DescribeFeatureType</entry>
            <entry>18</entry>
            <entry>0</entry>
          </row>     
          <row>
            <entry>1.3</entry>
            <entry>GetFeature</entry>
            <entry>368</entry>
            <entry>281</entry>
          </row>  
          <row>
            <entry>1.3.1</entry>
            <entry>Basic WFS tests</entry>
            <entry>20</entry>
            <entry>1</entry>
          </row>   
          <row>
            <entry>1.3.2</entry>
            <entry>Complex WFS tests</entry>
            <entry>18</entry>
            <entry>18</entry>
          </row>   
          <row>
            <entry>1.3.3</entry>
            <entry>Arithmetic filter WFS tests</entry>
            <entry>8</entry>
            <entry>8</entry>
          </row>   
          <row>
            <entry>1.3.4</entry>
            <entry>Comparison WFS tests</entry>
            <entry>50</entry>
            <entry>26</entry>
          </row>      
          <row>
            <entry>1.3.4.1</entry>
            <entry>GetFeature PropertyIsGreaterThanOrEqualTo filter</entry>
            <entry>2</entry>
            <entry>0</entry>
          </row>      
          <row>
            <entry>1.3.4.2</entry>
            <entry>GetFeature PropertyIsBetween filter</entry>
            <entry>6</entry>
            <entry>2</entry>
          </row>      
          <row>
            <entry>1.3.4.3</entry>
            <entry>GetFeature PropertyIsEqualTo filter</entry>
            <entry>4</entry>
            <entry>0</entry>
          </row>      
          <row>
            <entry>1.3.4.4</entry>
            <entry>GetFeature PropertyIsGreaterThan filter</entry>
            <entry>4</entry>
            <entry>2</entry>
          </row>   
          <row>
            <entry>1.3.4.5</entry>
            <entry>GetFeature PropertyIsGreaterThanOrEqualTo filter</entry>
            <entry>6</entry>
            <entry>6</entry>
          </row>   
          <row>
            <entry>1.3.4.6</entry>
            <entry>GetFeature PropertyIsLessThan filter</entry>
            <entry>6</entry>
            <entry>4</entry>
          </row>  
          <row>
            <entry>1.3.4.7</entry>
            <entry>GetFeature PropertyIsLessThanOrEqualTo filter</entry>
            <entry>6</entry>
            <entry>4</entry>
          </row>  
          <row>
            <entry>1.3.4.8</entry>
            <entry>GetFeature PropertyIsLike filter</entry>
            <entry>2</entry>
            <entry>0</entry>
          </row>  
          <row>
            <entry>1.3.4.9</entry>
            <entry>GetFeature PropertyIsNotEqualTo filter</entry>
            <entry>6</entry>
            <entry>0</entry>
          </row>  
          <row>
            <entry>1.3.4.10</entry>
            <entry>GetFeature PropertyIsNull filter</entry>
            <entry>8</entry>
            <entry>8</entry>
          </row>   
          <row>
            <entry>1.3.5</entry>
            <entry>Logical WFS test</entry>
            <entry>20</entry>
            <entry>0</entry>
          </row>   
          <row>
            <entry>1.3.5.1</entry>
            <entry>GetFeature AND PropertyIsEqualTo PropertyIsEqualTo filter</entry>
            <entry>8</entry>
            <entry>0</entry>
          </row>   
          <row>
            <entry>1.3.5.2</entry>
            <entry>GetFeature OR PropertyIsEqualTo PropertyIsEqualTo filter</entry>
            <entry>8</entry>
            <entry>0</entry>
          </row>  
          <row>
            <entry>1.3.5.3</entry>
            <entry>GetFeature NOT PropertyIsNotEqualTo filter</entry>
            <entry>4</entry>
            <entry>0</entry>
          </row>  
          <row>
            <entry>1.3.6</entry>
            <entry>Spatial operator WFS test</entry>
            <entry>252</entry>
            <entry>228</entry>
          </row> 
          <row>
            <entry>1.3.6.1</entry>
            <entry>GetFeature BBOX filter</entry>
            <entry>36</entry>
            <entry>12</entry>
          </row> 
          <row>
            <entry>1.3.6.2</entry>
            <entry>GetFeature with other filter types</entry>
            <entry>216</entry>
            <entry>216</entry>
          </row> 
          <row>
            <entry>2</entry>
            <entry>Transactional WFS test</entry>
            <entry>69</entry>
            <entry>69</entry>
          </row>           
        </tbody>
      </tgroup>
    </table> 
        <para>
                        The OGC Cite WFS test suite can be found on the OGC Cite portal (The Open Group; (2002), <emphasis>Test Requirements and Assertions for WFS 1.0.0</emphasis>). 
        </para>
        <para>
                        A extensive description of the tests can also be found on the OGC portal (The Open Group; (2003), <emphasis>How to test a Web Feature Service 1.0.0 service</emphasis>). 
        </para>
        <orderedlist>
          <listitem>
            <para>
                        Test number 1.3.1: 
            </para>
            <para>
                        There is a contradiction between the <filename>wfs/1.0.0/basic/getfeature/post/3</filename> assertion and the XPath expected value of the test. The assertion says: &quot;Test that a GetFeature request with no output format defined returns a wfs:FeatureCollection with GML data.&quot; and the expected XPath value for this request: &quot;<filename>boolean(/ogc:ServiceExceptionReport)</filename>&quot; is supposed to be true. So, the assertion means that when a WFS server receives a request which contains an undefined output format or no output format at all, the WFS server must return a WFS collection containing GML data. The XPath expected value means that when a WFS server receives a request with an undefined output format or no output format at all, the WFS server must return a service exception report. 
            </para>
          </listitem>
          <listitem>
            <para>
                        Tests number 1.3.2 and 1.3.3: 
            </para>
            <para>
                        Not supported. 
            </para>
          </listitem>
          <listitem>
            <para>                        
                        Tests number 1.3.4.2, 1.3.4.4 to 1.3.4.7 (see bug 461 on MapServer Web site): 
            </para>
            <para>
                        The string comparison is not supported using &gt;, &lt;, &gt;=, &lt;=. 
            </para>
            <para>
                        The date comparison is not supported.
            </para>
          </listitem>
          <listitem>
            <para>
                        Test number 1.3.4.10: 
            </para>
            <para>
                        This property is not supported in MapServer. 
            </para>
          </listitem>
          <listitem>
            <para>
                        Test number 1.3.6.1 (see bug 461 on MapServer Web site): 
            </para>
            <para>
                        The returned feature xml won't validate because the validation is done against a specific xsd (<filename>geomatry.xsd</filename>). 
            </para>
            <para>
                        The data conversion on multipoints and multilayers are not supported within gdal. 
            </para>
          </listitem>
          <listitem>
            <para>
                        Test number 2: 
            </para>
            <para>
                        The transaction requests are not supported. 
            </para>
          </listitem>
         </orderedlist>        
      </listitem>
    </itemizedlist>
  </sect1>   
  <sect1 id="docinfo">
    <title>             About this Document</title>
        <sect2 id="rhistory">
            <title>Revision History</title>
            <para>  
  The numbering is in parallel with the revision control
  system. Missing numbers indicate minor maintenance revision updates.
</para>
            <para>
                <revhistory>
                  <revision>
                    <revnumber>     1.00</revnumber>
                    <date>          2005-01-09</date>
                    <authorinitials>Author: Jeff McKenna</authorinitials>
                    <revremark>porting to UMN dockbook format, adding AY's previous changes to doc</revremark>
                  </revision> 
                  <revision>
                    <revnumber>     0.03</revnumber>
                    <date>          2004-11-23</date>
                    <authorinitials>AY</authorinitials>
                    <revremark>     minor edits</revremark>
                  </revision>                  
                  <revision>
                    <revnumber>     0.02</revnumber>
                    <date>          2004-03-12</date>
                    <authorinitials>Author: Darren Redfern</authorinitials>
                    <revremark>     edit and DocBook translation</revremark>
                  </revision>  
                  <revision>
                    <revnumber>     0.01</revnumber>
                    <date>          2004-03-10</date>
                    <authorinitials>YA</authorinitials>
                    <revremark>     initial draft</revremark>
                  </revision>                  
                </revhistory>
            </para>
        </sect2>    
    <sect2 id="copyright">
      <title>           Copyright/Licensing Information</title>
      <para>
                        Copyright (c) 2004, Yewondwossen Assefa, DM Solutions Group Inc.
      </para>
      <para>
                    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the &quot;Software&quot;), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
      </para>
      <para>
                    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
      </para>
      <para>
                    THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
      </para>
    </sect2>
    <sect2 id="feedback">
      <title> Feedback</title>
      <para>
            Input is appreciated.  Send any
            comments or suggestions to the MapServer Documentation Coordinator at
            <email>mdp@lists.gis.umn.edu</email>.
        </para>
    </sect2>
  </sect1>
</article>
