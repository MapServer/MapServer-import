<html>

<head>
<title>MapServer Cygwin Compilation</title>
</head>

<body bgcolor="#FFFFFF">

<h1>Compilation Cygwin de MapServer et Installation HOWTO</h1>

<p>Pericles S. Nacionales <br>
University of Minnesota <br>
Conservation Biology Program <br>
<a href="mailto:pnaciona@gis.umn.edu">pnaciona@gis.umn.edu</a><br>
<strong>Traduction</strong><br>
F.A. Van Den Bussche<br>
Club des Utilisateurs de Linux et des logiciels libres de Toulouse et des environs (CULTE)<br>
<a href="mailto:mapserver@favdb.net">mapserver@favdb.net</a><br>
<strong>Relecture</strong><br>
Nathalie Vielmas<br>
Club des Utilisateurs de Linux et des logiciels libres de Toulouse et des environs (CULTE)<br>
<a href="mailto:nath@favdb.net">nath@favdb.net</a> </p>

<h2>Abstract</h2>

<p>Ce HOWTO donne un ensemble de procédures pour compiler et installer MapServer sur une
plateforme Win32 en utilisant l'environnement Cygwin.</p>

<p>Dernière mise à jour: 16 November 2001 </p>

<h2><a name="toc">Sommaire</a> </h2>

<ol>
  <li><a href="#intro">Introduction</a> </li>
  <li><a href="#sect2">Obtenir les paquetages nécessaires</a></li>
  <li><a href="#sect3">Exemple de configuration MapServer</a></li>
  <li><a href="#sect4">Compilation</a> <ul>
      <li><a href="#libs">Bibliothèques supportées</a></li>
      <li><a href="#mapserv">MapServer</a></li>
    </ul>
  </li>
  <li><a href="#sect5">Installation</a> </li>
  <li><a href="#sect6">Problèmes habituels</a></li>
  <li><a href="#sect7">Remerciements</a></li>
  <li><a href="#sect6">Commentaires des utilisateurs</a></li>
</ol>

<hr>

<h2><b><a name="intro">Introduction</a> </b></h2>

<p>Si vous êtes famillier de <a href="http://www.cygwin.com">Cygwin</a> et que vous
connaissez déjà MapServer, vous pouvez passer directement au chapitre suivant, dans la
partie &quot;<a href="#sect3">Exemple de configuration MapServer</a>&quot;. Si vous venez
juste de débuter avec Cygwin et MapServer, vous devriez commencer ici. Si vous n'avez
jamais entendu parlé de MapServer, vous n'êtes pas au bon endroit; allez <a
href="http://mapserver.gis.umn.edu">ici</a> d'abord. Pour tous les autres, commençons.</p>

<p>MapServer de l'université du Minnesota est un logiciel libre dont les sources sont
disponibles pour construire des applications oueb de cartographie. Il est utilisé par un
nombre croissant au sein de la communauté SIG (GIS) et par ceux qui utilisent l'internet
comme un moyen de présenter des informations geospaciales. MapServer peut être
configuré et compilé pour plusieurs systèmes d'exploitation, ce document est consacré
à la compilation et à l'installation de MapServer sur l'environnement Cygwin qui
fonctionne sur les systèmes d'exploitation Win32. </p>

<p>Puisque Cygwin est un environnement UNIX-like et que les outils GNU y sont disponibles,
la connaissance de l'environnement shell UNIX sera très utile. Si vous n'êtes pas
famillier du shell bash, je vous suggère d'envisager les autres possibilités pour
compiler MapServer sur Windows&#151;l'une de ces alternatives est Microsoft Visual C/C++
(MSVC). Il y a un document <a href="win32_compile-howto_fr.html">HOW-TO</a> pour compiler
MapServer avec MSVC. Pour ceux qui ne connaissent pas trop le shell UNIX mais qui
souhaitent quand même utiliser Cygwin pour compiler MapServer, je tenterai de fournir des
étapes simples à suivre pour la compilation. Mis à part la connaissance de
l'environnement shel d'UNIX, ceux qui veulent compiler MapServer sous Cygwin devrait aussi
connaître l'environnement de &quot;construction&quot;--en particulier les autoconf et
make GNU. </p>

<p>Pour l'installation et le développement d'applications, les connaisances de base de la
configuration du serveur oueb et de l'environnement CGI sera nécessaire. Le binaire
MapServer compilé sous Cygwin est connu pour fonctionner sur un serveur Apache et c'est
ce serveur que j'utiliserai dans ce document. </p>

<p><i>Note: Cygwin et les ouils GNU qu'il conteint sont en constante évolution.
J'utilisais Cygwin avec la version DLL 1.3.3 lors de la rédaction originale de ce HOWTO.
Aussi j'espère que vous ne rencontrerez pas de problèmes de compatibilité avec des
versions différentes de Cygwin, je ne pas vous le garantir. Je vous recommande de vous
mettre au niveau de la dernière version si vous utilisez une ancienne version de DLL
(antérieure à 1.3.x).</i></p>

<p><a href="#toc">Revenir au sommaire</a></p>

<p>&nbsp;</p>

<h2><b><a name="sect2">Obtenir les paquetages logiciels nécessaires</a></b></h2>

<p>Le code source de MapServer peut être téléchargé sous forme de paquetage sur <a
href="http://mapserver.gis.umn.edu/dload.html">http://mapserver.gis.umn.edu/dload.html</a>.
Téléchargez la dernière version de MapServer (NdT 3.6) ou la dernière version de
développement constituée quotidiennement. </p>

<p>Des paquetages complémentaires sont nécessaires pour le traitement des entrées et
sorties de données supportées par MapServer. Plusieurs paquetages&nbsp; (bibliothèques)
sont indispensables au bon fonctionnement de MapServer, et certains autres peuvent fournir
des possibilités supplémentaires mais ne sont pas indispensables. Certains paquetages
sont intégrés à Cygwin et n'ont pas besoin d'être compilés. Pour ceux qui ne sont pas
inclus dans Cygwin, téléchargez et compiles les avant la compilation de MapServer. Voici
certaines des bibliothèques nécessaires ou facultatives pour la compilation de
MapServer: 

<ul>
  <li><a href="http://www.boutell.com/gd/">GD</a>: Nécessaire pour la restitution des cartes
    (comme les graphiques GIF ou PNG). </li>
  <li><a href="http://www.libpng.org/pub/png/">LibPNG</a>: Nécessaire pour GD et, donc,
    nécessaire pour construire MapServer</li>
  <li><a href="http://www.gzip.org/zlib/">Zlib</a>: Comme avec LibPNG, est aussi requise par
    GD</li>
  <li><a href="http://sourceforge.net/projects/freetype/">LibFreeType/LibTTF</a>: LibFreeType
    est la version 2.x et LibTTF est l'ancienne version--l'une d'elles est nécessaire pour
    être installée si vous vous souhaitez employer les polices de caractères TrueType sous
    GD et MapServer. (facultatif) </li>
  <li><a href="http://www.remotesensing.org/proj/">Proj.4</a>: Est requise pour la conversion
    de projection &quot;à la volée&quot; --un pré-requis pour le support OGC WMS. Assurez
    vous d'obtenir la dernière version si vous voulez utiliser le support WMS. (facultatif
    mais fortement recommandé) </li>
  <li><a href="http://www.w3c.org/Library/">LibWWW</a>: Nécessaire pour les connections WMS
    clientes. (facultatif mais necessaire pour conformité WMS Client) </li>
  <li><a href="http://www.libtiff.org/">LibTIFF</a>: Si vous souhaitez que MapServer puisse
    lire les images TIFF, vous en aurez besoin. Comme alternative, vous pouvez utiliser GDAL
    pour le support&nbsp; TIFF. (facultatif) </li>
  <li><a href="http://www.ijg.org">LibJPEG</a>: Nécessaire pour le support des images JPEG.
    Comme alternative, vous pouvez utiliser GDAL pour le support JPEG. (facultative) </li>
  <li><a href="http://www.remotesensing.org/gdal/">GDAL</a>: Si vous voulez supporter les
    différents formats d'images raster (y compris le TIFF et le JPEG), c'est ce dont vous
    avez besoin. (facultatif) </li>
  <li><a href="http://gdal.velocet.ca/projects/opengis/index.html">OGR Simple Features Library</a>:
    Fournit le support pour un nombre important de format de données vectorisées. Fait
    partie de la distribution GDAL. (Optional) </li>
  <li><a href="http://www.postgresql.org/">PostgreSQL Client</a>: Nécessaire pour <a
    href="http://postgis.refractions.net/">PostGIS</a>. </li>
  <li>Pour les autres bibliothèques qui peuvent accroître les fonctionnalités de MapServer,
    voyez le <a href="http://mapserver.gis.umn.edu">site MapServer</a>.</li>
</ul>

<p>Si vous voulez utiliser l'une de ces bibliothèques cliquez sur le lien indiqué. Lisez
la documentation de ces logiciels avant de les télécharger. Quand vous téléchargez le
logiciel, placez le dans un répertoire. C'est ce répertoire que vous utiliserez pour
compiler MapServer et les bibliothèques. </p>

<p><i>Truc: Créez un sous répertoire &quot;projects&quot; dans le répertoire /usr/src .
Dans Cygwin, utilisez la commande: &quot;mkdir /usr/src/projects&quot;. Si vous utilisez
l'explorateur Windows, créez le dossier &quot;projects&quot; sous C:\Cygwin\usr\src, ou
à l'endroit où vous avez installé Cygwin. Vous pouvez ensuite mettre tous les codes
sources téléchargés dans ce répertoire. </i></p>

<p><a href="#toc">Retour au sommaire</a></p>

<p>&nbsp;</p>

<h2><b><a name="sect3">Exemple de configuration du logiciel MapServer</a></b></h2>

<p>Cygwin intègre les bibliothèques GD, LibPNG, Zlib, LibTIFF, et LibJPEG. Pour compiler
MapServer avec la sortie PNG et les fichiers de formes (Shapefile) et les entrées
TIFF/JPEG, vous êtes prêt. Si vous voulez la sortie GIF et que vous n'êtes pas
concerné par la licence LZW, je vous suggère de télécharger une bibliothèque
modifiée sur <a href="http://www.rime.com.au/gd/">http://www.rime.com.au/gd/</a>.</p>

<p>A partir de maintenant je prendrai un exemple que les utilisateurs peuvent suivre et
appliquer. Le programme CGI MapServer que je compilerai disposera de l'entrée &quot;ESRI
shapefiles&quot;, aussi bien que des images TIF et JPEG. Aucune bibliothèque
particulière n'est nécessaire puisque MapServer dispose de la fonction intégrée
Shapelib et que les bibliothèques TIFF et JPEG sont incluses dans Cygwin. J'incluerai
aussi Proj.4 pour disposer de la projection &quot;à la volée&quot; pour mes données.
Comme j'ai Proj.4, je peux fabriquer mon MapServer comme serveur compatible OGC-WMS. Comme
je veux de bonne polices de caractères, j'aurais aussi à compiler MapServer avec
Freetype 1.3 (parce que j'ai quelques problèmes avec Freetype2 :). Puisque Cygwin dispose
déjà de GD 1.8.4, j'ai la possibilité de choisir d'utiliser des images PNG ou JPEG pour
mes sorties. De toute façon, beaucoup de personnes aimeraient utiliser les images GIF
aussi je telechargerai la bibilothèque GD &quot;patchée&quot; GD avec le support
automake (parce qu'il n'y a rien de plus simple que automake) sur
http://www.rime.com.au/gd. Soyez prudent sur les contraintes de licence. </p>

<p>Donc, téléchargez la &quot;patched gd library with GIF and Automake support&quot; sur
http://www.rime.com.au/gd dans /usr/src/projects. Ensuite décompressez le paquetage en
utilisant Cygwin. Voci la commande pour faire çà: &quot;tar -xzvf
gd-1.8.4amgif.tar.gz&quot; Vous pourriez terminer cette commande avec le sous répertoire
appelé gd-1.8.4 sous /usr/src/projects. Vous devez supprimer le fichier après sa
décompression (&quot;rm gd-1.8.4amgif.tar.gz&quot;). </p>

<p>Téléchargez le source Freetype 1.3 sur
http://prdownloads.sourceforge.net/freetype/freetype-1.3.1.tar.gz et décompressez comme
suit: tar -xzvf freetype-1.3.1.tar.gz. Vous devez supprimer le fichier après sa
décompression. </p>

<p>Téléchargez le source Proj.4 depuis
ftp://ftp.remotesensing.org/pub/proj/proj-4.4.4.tar.gz et décompressez comme suit: tar
-xzvf proj-4.4.4.tar.gz. Après décompression, téléchargez proj-nad27-1.1.tar.gz depuis
ftp://ftp.remotesensing.org/pub/proj vers /usr/src/projects/proj-4.4.4/nad
(C:\Cygwin\usr\src\proj-4.4.4\nad). Changez de répertoire pour aller sous proj-4.4.4/nad
et décompressez ce que vous venez de télécharger. Supprimez le fichier source après sa
décompression.</p>

<p>Téléchargez le source de MapServer sur
http://mapserver.gis.umn.edu/dist/nightly.tar.gz et décompressez comme suit: tar -xzvf
nightly.tar.gz. Ceci créera un répertoire applé mapserver. Vous devriez avoir
maintenant la structure de répertoire suivante: </p>

<pre>/usr/src/projects/
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; freetype/
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gd-1.8.4/
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proj-4.4.4/
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mapserver/
</pre>

<p>Une dernière chose... Téléchargez <a
href="ftp://ftp.gnu.org/pub/gnu/regex/regex-0.12.tar.gz">Regex-0.12</a> depuis
ftp://ftp.gnu.org/pub/gnu/regex/. Cygwin intègre regex, cette version ne fonctionne pas
avec MapServer pour quelque mystérieuse raison. J'ai résolu le problème en utilisant
cet ancienne version de regex. Décompressez le fichier dans le répertoire mapserver
(depuis /usr/src/projects/mapserver) comme suit: &quot;tar -xzvf regex-012.tar.gz&quot;.
Votre nouveau sous répertoire regex devrait être
&quot;/usr/src/projects/mapserver/regex-0.12&quot;. Vous êtes maintenant prêt à
compiler MapServer et les bibliothèques nécessaires.</p>

<p><a href="#toc">Retour au sommaire</a></p>

<p>&nbsp; </p>

<h2><a name="sect4"><b>Compilation</b></a></h2>

<h3><a name="libs"><b>Bibliothèques</b></a></h3>

<p>Before you can actually compile MapServer, you need to compile all the supporting
libraries. This example calls for the patched gd-1.8.4, freetype, and proj.4 libraries.
The steps in compiling and installing these libraries are similar to each other but there
is order in what should be compiled first. By this I mean that some libraries
&quot;depend&quot; on other libraries, much like MapServer depends on these libraries. In
the case of GD, you can compile it as is. However, since I need freetype support in
MapServer, I need to compile this support into gd. So I will first compile and install
freetype before compiling GD. Proj.4 doesn't have any dependencies so we can compile it
anytime. Well, I'll compile it first then.</p>

<p><b>Proj.4</b> <br>
Pour compiler Proj.4, placez vous dans le répertoire /usr/src/projects. Tappez
&quot;./configure&quot;. Ceci demandera à votre système de générer un Makefile pour
vous--l'une des bonnes choses de l'environnement UNIX. Lorsque configure a fini de
générer le Makefile, tappez simplement &quot;make&quot;. Quand Proj.4 est compilé,
tappez &quot;make install&quot;. Ceci installera la bibliothèque Proj.4, en-tête et
fichiers de donnéesdans le répertoire &quot;/usr/local&quot;. Si vous le souhaitez, vous
pouvez lancer la commande &quot;make clean&quot; pour supprimer les fichiers créés
durant le processus de compilation. Vous en avez terminé avec Proj.4. </p>

<p><b>Freetype </b><br>
Puisque GD &quot;depend&quot; de Freetype pour les polices TrueType, vous avez besoin de
la compiler en premier. Pour celà, placez vous dans le répertoire Freetype en tappant
&quot;cd ../freetype&quot; (puisque vous êtes dans le répertoire Proj.4. Sinon, tappez
&quot;cd /usr/src/projects/freetype&quot;). Tappez &quot;./configure&quot; et attendez en
la fin. Maintenant tappez &quot;cd lib&quot; pour aller dans le répertoire lib. Tappez
&quot;cp arch/unix/Makefile arch/win32/&quot;--ceci copiera votre Makefile dans le sous
répertoire arch/win32. Editez le &quot;arch/win32/Makefile&quot; avec votre éditeur de
texte favorit. Cherchez les lignes:</p>

<pre>VPATH = /cygdrive/d/projects/gnu/mapserver/freetype/lib/arch/unix/../.. 
srcdir = /cygdrive/d/projects/gnu/mapserver/freetype/lib/arch/unix/../.. </pre>

<p>et changez les en: <br>
</p>

<pre>VPATH = /cygdrive/d/projects/gnu/mapserver/freetype/lib/arch/win32/../.. 
srcdir = /cygdrive/d/projects/gnu/mapserver/freetype/lib/arch/win32/../.. </pre>

<p>N'oubliez pas d'enregistrer vos modifications. Maintenant retournez dans la console
Cygwin, tappez &quot;make -f arch/win32/Makefile&quot; et attendez que la compilation se
termine. Quand la compilation est finie tappez &quot;make -f arch/win32/Makefile
install&quot; pour installer la bibliothèque library et les fichiers d'en-tête. Si vous
le souhaitez, tappez &quot;make clean&quot; pour débarrasser des fichiers intermédiaires
créés lors de la procédure de compilation. Vous en avez terminé avec Freetype. </p>

<p><b>GD </b><br>
Vous aurez à compiler GD pour deux raisons--le support GIF et Freetype. Si vous n'avez
pas besoin du GIF puisque vous pensez utiliser les graphiques PNG pour les sorties
MapServer, vous n'aurez pas à la compiler. Mais, en ne compilant pas GD vous n'aurez pas
non plus l'usage des polices Truetype--le GD inclus dans Cygwin n'a pas été compilé
avec Freetype. Donc, si vous voulez utiliser les polices TrueType mais que vous n'avez pas
besoin du GIF, vous pouvez utiliser le GD &quot;officiel&quot; disponible sur <a
href="http://www.boutell.com/gd/">http://www.boutell.com/gd/</a>. </p>

<p>Pour compiler, placez vous dans le répertoire GD (&quot;cd ../gd-1.8.4&quot;) et
tappez &quot;./configure --help |more&quot; pour voir les options disponibles pour le
script de configuration. Utilisez l'option &quot;--enable-gnu-ld&quot; de manière à
inclure le support Freetype. Aussi, cette fois tappez &quot;./configure --enable-gnu-ld
--enable-freetype&quot;. Malheureusement, configure ne trouve pas les fichiers d'en-tête
Freetype aussi vous devez introduire quelques modifications dans le Makefile. Editez le
Makefile avec votre éditeur de texte favorit. Cherchez les lignes:</p>

<pre>DEFS = -DPACKAGE=\&quot;gd\&quot; -DVERSION=\&quot;1.8.4\&quot; -DHAVE_LIBM=1 -DHAVE_LIBZ=1 -DHAVE_LIBPNG=1 -DSTDC_HEADERS=1 -DHAVE_MALLOC_H=1 -DHAVE_UNISTD_H=1 -DHAVE_ZLIB_H=1 -DHAVE_PNG_H=1 -I. -I$(srcdir) 
CPPFLAGS = -I${prefix}/include -INONE 
LDFLAGS = -L${exec_prefix}/lib -LNONE </pre>

<p>et remplacez les par: </p>

<pre>DEFS = -DPACKAGE=\&quot;gd\&quot; -DVERSION=\&quot;1.8.4\&quot; -DHAVE_LIBTTF -DHAVE_LIBM=1 -DHAVE_LIBZ=1 -DHAVE_LIBPNG=1 -DSTDC_HEADERS=1 -DHAVE_MALLOC_H=1 -DHAVE_UNISTD_H=1 -DHAVE_ZLIB_H=1 -DHAVE_PNG_H=1 -I. -I$(srcdir) 
CPPFLAGS = -I${prefix}/include/freetype -I${prefix}/include -I. 
LDFLAGS = -L${exec_prefix}/lib -L.</pre>

<p>N'oubliez pas d'enregistrer les modifications. Maintenant retournez dans la console,
tappez &quot;make&quot; et attendez en la fin. Testez si le support Freetype fonctionne
correctement en tappant &quot;./gdtestttf&quot;. Vous devrez obtenir le message suivant: </p>

<pre>HEY! THIS IS FOR THE FREETYPE 1.x LIBRARY. </pre>

<pre>For better results, look at 'gdtestft' and the 
new gdImageStringFT function, which uses 
the new FreeType 2.x library. </pre>

<pre>libgd was not built with TrueType font support</pre>

<p>Ceci est un message parfait--ignorez la dernière ligne. Cà fonctionne. N'installez
pas cette bibliothèque pour ne pas entrer en conflit avec la bibliothèque GD existant
(Sauf si vous voulez vraiment la remplacer... Ne me demandez pas comment.) </p>

<p><b>Autres bibliothèques</b>. <br>
Si vous voulez compiler d'autres bibliothèques, comme gdal/ogr ou libwww, le process sera
similaire, typiquement décompressé chaque source, exécutez ./configure, et make.
Assurez vous de vérifier les fichiers README exécutez ./configure avec --help pour
exéminer les options disponibles. Souvent vous à valider ou à invalider certaines
options. Mais au point où vous en êtes, vous avez l'expérience. </p>

<p>Bien ensuite... Voyons MapServer. </p>

<h3><b><a name="mapserv">MapServer</a></b></h3>

<p>A ce point vous seriez tenté d'essayer juste &quot;./configure; make&quot;. Mais
encore une fois, vous devriez réaliser que ce n'est pas aussi simple. Donc, je vais
détailler celà lentement. En premier, allez dans le répertoire mapserver et tappez
&quot;./configure --help&quot; pour examiner et réfléchir sur les otpions à donner au
script de configuration. Maintenant, si vous avez simplement fait &quot;./configure&quot;
nous n'aurons pas la nouvelle bibliothèque GD puisque nous ne l'avons pas installée.
Vous devez impérativement utiliser l'option &quot;--with-gd=[DIR]&quot;. De même, le
script de configuration peut ne pas trouver Proj.4 aussi vous devez utiliser l'option
&quot;--with-proj=[DIR]&quot;. C'est tout ce dont nous avons besoin pour cet exemple, mais
si vous voulez ajouter d'autres bibliothèques vous devriez utiliser les options &nbsp;
supplémentaires--GDAL, par exemple, a besoin de &quot;--with-gdal=[gdal-config
directory]&quot;. Vous n'aurez probablement besoin des bibliothèques TIFF et JPEG lorsque
vous utilisez GDAL. </p>

<p>Mais revenons à notre exemple. Tappez &quot;./configure --with-gd=../gd-1.8.4
--with-proj=/usr/local&quot; pour générer notre Makefile. Après la génération du
Makefile, vérifiez le en l'ouvrant dans votre éditeur de texte favorit. Assurez vous que
la ligne &quot;GD_LIB&quot; a bien -lttf et non -lfreetype (nous utilisons Freetype 1.3,
vous vous en souvenez?). De même, vérifiez la igne &quot;GD&quot; pour vous assurer
qu'il y a bien -DUSE_GD_TTF et non -DUSE_GD_FT. Enfin, vérifiez la ligne
&quot;TIFF_LIB&quot; pour -lttf et non -lfreetype. </p>

<p>Maintenant vous avez besoin d'incorporer la fonction regex dans le Makefile. Je suppose
que nous pourrions l'ajouter dans le Makefile.in avant de lancer le script de
configuration--vous pouvez le faire si vous le souhaitez. Donc, localisez les lignes:</p>

<pre>REGEX_OBJ= @PHP_REGEX_OBJ@
REGEX_INC= @PHP_REGEX_INC@
</pre>

<p>et remplacez les par:</p>

<pre>REGEX_OBJ=regex-0.12/regex.o
REGEX_INC=-I./regex-0.12
MAKE_REGEX=regex
MAKE_REGEX_CLEAN=regex_clean
</pre>

<p>Maitenant, ajoutez les lignes suivantes quelque part à la fin du Makefile, de
préférence après l'élément &quot;egis::&quot;:</p>

<pre>regex:
       cd regex-0.12; make; cd ..</pre>

<p>Enfin, ajoutez ces trois lignes après l'élément &quot;egis_clean:&quot;:</p>

<pre>regex_clean:
      cd regex-0.12; $(MAKE) clean; cd ..</pre>

<p>Enregistrez vos modifications. Vous êtes maintenant prêt à compiler. Allons y,
&quot;make&quot; votre CGI MapServer. </p>

<p>Quand le processus de compilation est terminé, il devrait avoir créé plusieurs
exécutables (avec l'extension .exe). Mapserv.exe est le programme CGI dont nous avons
besoin pour contsruire les applications MapServer. Les autres exécutables sont des outils
pour la création de fichiers de formes (shapefile) indexés, trier des bases de données,
et générer les sorties de cartes et légendes. Testez mapserv.exe en tappant
&quot;./mapserv -v&quot;. Vous devriez obtenir un message du type: </p>

<pre>$ ./mapserv -v 
MapServer version 3.5 (beta) OUTPUT=GIF OUTPUT=PNG OUTPUT=JPEG OUTPUT=WBMP SUPPO    
RTS=PROJ SUPPORTS=TTF SUPPORTS=WMS_SERVER INPUT=TIFF INPUT=EPPL7 INPUT=JPEG INPU 
T=SHAPEFILE </pre>

<p>et si vous tappez seulement &quot;./mapserv&quot;, vous devriez avoir quelque chose
comme: </p>

<pre>This script can only be used to decode form results and 
should be initiated as a CGI process via a httpd server. </pre>

<p>Félicitations! Vous avez compilez avec succès MapServer sous Cygwin. Maintenant vous
êtes prêt à l'installer et à l'utiliser.</p>

<p><a href="#toc">Retour au sommaire</a></p>

<p>&nbsp;</p>

<h2><b><a name="sect5">Installation </a></b></h2>

<p>Comme précisé précédemment, le programme CGI Mapserver compilé ave Cygwin est
seulement connu pour être utilisé avec Apache. Apache lui-même est actuellement
disponible pour Windows sous deux formes--compilation native ou Cygwin. Si vous n'avez pas
déjà installé l'un ou l'autre, c'est maintenant le moment de faire votre choix. Les
binaires du serveur Apache peuvent s'obtenir sur
http://httpd.apache.org/dist/httpd/binaries/. Si vous voulez la version Cygwinallez dans
sous répertoire &quot;cygwin&quot;, sinon allez dans &quot;win32&quot;. Extrayez le
paquetage Cygwin dans votre sous répertoire /usr/src/projects. A partir de là, vous
pouvez lire les instructions d'installation. Le paquetage binaire Win32 est donné avec
ses propres instructions d'installation; lisez les avant de procéder à l'installation de
MapServer.</p>

<p>Si vous utilisez le serveur Apache sous Cygwin, l'installation pourra être plus
complexe--mettez simplement mapserv.exe dans le répertoire cgi-bin et vous serez prêt à
continuer. Vous devriez maintenant poursuivre par l'installation de la démonstration
MapServer, ou en créant vos nouvelles applications.</p>

<p>Si vous préférez utiliser le Apache &quot;normal&quot; pour Windows, vous devez
gardez ceci à l'esprit: installez Apache dans un répertoire sans espace dans son nom.
MapServer ne fonctionnera pas si vous installez Apache par défaut--&quot;c:\program
files\apache group\apache&quot;. Au lieu de çà, vous devrez l'installer dans c:\apache
ou c:\apps\apache (ou simplement sous c:\, où l'installation créera un sous répertoire
&quot;apache&quot;). Vous devez aussi inclure le sous répertoire bin de Cygwin
(C:\Cygwin\bin) dans vos chemeins systèmes. Ceci se fait en faisant un clique droit sur
&quot;Poste de travail&quot; puis sur le menu &quot;Propriétés&quot;. Dans les
propriétés du système sélectionnez l'onglet &quot;Avancé&quot; et cliquez sur le
bouton &quot;variables d'environnement&quot;. Le reste devrait être évident pour vous.
Rappelez vous que vous devez avoir les droits administrateur pour changer le paramétrage
système. Lorsque c'est fait, copiez simplement le mapserv.exe dans le répertoire
cgi-bin. </p>

<p>Quant aux programmes utilitaires MapServer, je les mettrais dans /usr/local/bin. Vous
pouvez les installer dans Cygwin en tappant &quot;make install&quot; après la compilation
de MapServer.</p>

<p><a href="#toc">Retour au sommaire</a></p>

<p>&nbsp;</p>

<h2><a name="sect6"><b>Problèmes habituels</b></a></h2>

<p>Je suis en train de collecter quelques uns des problèmes les plus connus lors de la
compilation et l'utilisation du MapServeur Cygwin. Si vous en rencontrez un faites le moi
savoir... encore plus si vous avez trouvé la solution. :)</p>

<p>LD_LIB_PATH (problémes avec l'installation de bibliothèques sous /usr/local)</p>

<p>Problèmes en relation avec Apache</p>

<p><a href="#toc">Retour au sommaire</a></p>

<p>&nbsp;</p>

<h2><b><a name="sect7">Remerciements</a></b></h2>

<p>Norman Vine et David Fawcett qui ont repondu à mes question sur Apache. Stephen
Woodbridge qui m'a donné plusieurs suggestions sur ce document. Jamie Smedsmo qui a
publié ce bien pauvre HOWTO. Merci à eux. Plusieurs personnes m'ont prodigué leurs
encouragements pour la réalisation de ce document--merci aussi à eux! J'espère que ce
travail aidera ceux qui veulent essayer le meilleur des logiciels libres et open-source.</p>

<p><a href="#toc">Retour au sommaire</a></p>

<p>&nbsp;</p>

<h2><b><a name="sect7">Commentaires des utilisateurs: </a></b></h2>
</body>
</html>
