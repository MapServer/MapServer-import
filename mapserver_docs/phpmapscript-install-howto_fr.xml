<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.1.2//EN" "http://mapserver.gis.umn.edu/mdp/docbkx412/docbookx.dtd">
<!-- $Id$ -->
<article>
  <articleinfo>
    <!-- insert title here, include the word HOWTO -->
    <title>Mapserver PHP/Mapscript Installation HOWTO - Version 4.2</title>
    <author>
      <firstname>Jeff</firstname>
      <surname>McKenna</surname>
      <affiliation>
        <orgname>DM Solutions Group Inc.</orgname>
        <address>
          <email>mckenna@dmsolutions.ca</email>
        </address>
      </affiliation>
    </author>
    <othercredit>
      <contrib>Traduction</contrib>
      <firstname>Franz-Albert</firstname>
      <surname>Van Den Bussche</surname>
      <affiliation>
        <orgname>Club des Utilisateurs de Linux et des logiciels libres de Toulouse et des environs</orgname>
        <orgdiv>CULTe</orgdiv>
        <address>
          <email>franz@favdb.net</email>
        </address>
      </affiliation>
    </othercredit>
    <othercredit>
      <contrib>Relecture</contrib>
      <firstname>Nathalie</firstname>
      <surname>Vielmas</surname>
      <affiliation>
        <orgname>Club des Utilisateurs de Linux et des logiciels libres de Toulouse et des environs</orgname>
        <orgdiv>CULTe</orgdiv>
        <address>
          <email>nath@favdb.net</email>
        </address>
      </affiliation>
    </othercredit>
    <date>2001-11-06</date>
    <abstract>
      <!-- a short description of the contents of the doc -->
      <para>
         Ce document décrit les procédures pour obtenir, compiler et installer le module PHP/Mapscript Module pour Mapserver.
      </para>
      <para>Dernière mise à jour: 11/06/2001</para>
    </abstract>
  </articleinfo>
  <sect1 id="intro">
    <title>Introduction</title>
    <para>
      Le module PHP/MapScript est un module PHP chargeable dynamiquement qui rend disponible l'accès aux fonctions et classes de <ulink url="mapscript_fr.html">MapScript de MapServer</ulink> dans un environnement PHP3/PHP4.     
          </para>
    <para>
      La version d'origine de MapScript (en Perl) utilise <ulink url="http://www.swig.org/">SWIG</ulink>, mais puisque SWIG ne reconnaît pas le langage PHP, le module a été maintenu séparément et n'est pas synchrone avec la version Perl. 
          </para>
    <para>
      Le module PHP a été développé et est actuellement maintenu par <ulink url="http://www.dmsolutions.ca/">DM Solutions Group</ulink>. 
          </para>
    <para>
             Ce document considère que vous êtes familier de certains aspects de votre système d'exploitation:
          </para>
    <itemizedlist>
      <listitem>
        <para>
                      Pour les utilisateurs Unix/Linux, une connaissance de l'environnement de développement, en particulier 'make'.
                </para>
      </listitem>
      <listitem>
        <para>
          Pour les utilisateurs Windows, une certaine dextérité pour la compilation si vous n'avez pas eu accès à une version précompilée. Vous aurez donc à compiler votre propre exemplaire de MapServer avec son module PHP/Mapscript.
        </para>
      </listitem>
    </itemizedlist>
    <!-- Section2: Which version -->
    <sect2 id="version">
      <title>Quelle est la version de PHP à utiliser?</title>
      <para>
        Le module a été développé à l'origine pour PHP-3.0.14 et fonctionne avec les versions récentes de PHP3. Il est aussi porté sous PHP4: l'utilisation de PHP4 a commencé avec la version 3.4 de MapServer.
      </para>
      <para>    
        Notez qu'un PHP MapScript compilé pour PHP3 ne fonctionnera pas avec PHP4 et vice-versa. Le script de configuration de MapServer détectera automatiquement quelle version de PHP vous tentez d'utiliser pour la construction et prendra toutes les dispositions utiles. 
      </para>
      <para>
        Les meilleures combinaisons des versions de Mapscript et PHP sont:
      </para>
      <itemizedlist>
        <listitem>
          <para>
            Mapscript 3.4 avec PHP4.0.4p11 ou 4.0.5 (ne fonctionne pas avec PHP4.0.6).
          </para>
        </listitem>
        <listitem>
          <para>
            Mapscript 3.5 avec PHP4.0.6 (PHP &lt; 4.0.6 n'est plus fonctionnel).
          </para>
        </listitem>
      </itemizedlist>
    </sect2>
    <!-- Section2: More information on the module -->
    <sect2 id="information">
      <title>Se procurer de l'information sur le module PHP/Mapscript Module pour Mapserver</title>
      <itemizedlist>
        <listitem>
          <para>
                      Vous pouvez trouver plus d'information sur le module PHP/Mapscript sur <ulink url="http://www.maptools.org/php_mapscript/">http://www.maptools.org/php_mapscript/</ulink>.
               </para>
        </listitem>
        <listitem>
          <para>
                Les questions concernant le module peuvent être adressées à la <ulink url="support_fr.html">liste de diffusion Mapserver</ulink>. NdT : ATTENTION cette liste de diffusion est anglophone, avec un peu de chance si vous posez votre question en français un francophone pourra vous répondre, le plus souvent ce ne sera pas le cas; aussi je vous recommande de vous exprimer en anglais sur cette liste, même si c'est un anglais approximatif, vous ne serez jamais ridicule.
      </para>
        </listitem>
      </itemizedlist>
    </sect2>
  </sect1>
  <!-- Section1: obtaining and installing -->
  <sect1 id="obtain">
    <title>Obtenir, compiler et installer PHP et le module PHP/Mascript</title>
    <sect2 id="download">
      <title>Télécharger PHP et PHP/Mapscript</title>
      <itemizedlist>
        <listitem>
          <para>
             Les sources PHP ou les binaires Win32 peuvent être obtenus depuis le site officiel PHP à l'URL <ulink url="http://www.php.net/">http://www.php.net/</ulink>.
          </para>
        </listitem>
        <listitem>
          <para>
            Après avoir vérifié que PHP est installé et qu'il fonctionne, vous avez à vous procurer la dernière version des sources de MapServer (voir <ulink url="http://mapserver.gis.umn.edu/dload.html"> http://mapserver.gis.umn.edu/dload.html</ulink>) et à compiler MapServer et le module PHP. 
            </para>
        </listitem>
      </itemizedlist>
    </sect2>
    <sect2 id="server">
      <title>Paramétrer PHP sur votre serveur</title>
      <sect3 id="unix">
        <title>Unix</title>
        <itemizedlist>
          <listitem>
            <para>
              Vérifiez que PHP est déjà installé (disponible avec la quasi totalité des distributions Linux).
            </para>
          </listitem>
          <listitem>
            <para>
              Si non, voyez le document <ulink url="http://php.net/manual/en/install.unix.php">http://php.net/manual/en/install.unix.php</ulink>.
            </para>
          </listitem>
        </itemizedlist>
      </sect3>
      <sect3 id="windoze_ohno">
        <title>Windows</title>
        <itemizedlist>
          <listitem>
            <para>
              L'URL <ulink url="http://sourceforge.net/projects/foxserv/">SourceForge project FoxServ</ulink> vous procurera une installation simple pour Windows contenant les récentes versions de Apache, MySQL, et PHP; de toute façon, au moment de la dernière mise à jour de ce HOWTO il apparaît que le projet FoxServ semble abandonné, aussi l'installation de FoxServ est donc dépassée lorsque vous la téléchargerez. NdT : essayez donc de récupérer EasyPHP qui intègre les mêmes éléments (non testé en totalité).
            </para>
          </listitem>
          <listitem>
            <para>
              Les utilisateurs Windows doivent suivre les étapes 1 à 9 du document <ulink url="http://www.net-language.com/workshops/Default.asp?workshop=21">Installing Apache, PHP4 and MySQL on Win98</ulink> pour installer manuellement Apache et PHP4 sur leur système.
          </para>
          </listitem>
          <listitem>
            <para>
                    Les utilisateurs du produit PWS/IIS pour Windows peuvent consulter ces liens:
                  </para>
            <itemizedlist>
              <listitem>
                <para>
                  <ulink url="http://www.php.net/manual/en/install.iis.php">Php.net's</ulink> howto pour installer PHP pour PWS/IIS 3, PWS 4 ou plus récent, et IIS 4 ou plus récent. 
                </para>
              </listitem>
            </itemizedlist>
          </listitem>
        </itemizedlist>
        <note>
          <para>Pour le paramétrage de PHP sur Windows, assurez-vous que PHP est configuré comme un CGI et non comme un module Apache parce que <filename>php4_mapscript.dll</filename> n'est pas thread-safe et ne fonctionne pas comme un module Apache (voir <link linkend="example">"Example Steps of a Full Windows Installation"</link>).
          </para>
        </note>
      </sect3>
    </sect2>
    <sect2 id="build">
      <title>Construire/Installer le module PHP/Mapscript</title>
      <sect3 id="build_lunix">
        <title>Construction pour une Linux Box</title>
        <para>
          <emphasis>NOTE:</emphasis> Pour les utilisateurs UNIX, voyez le fichier <emphasis>README.CONFIGURE</emphasis> dans les sources de MapServer, ou voyez le HOWTO UNIX/MapServer sur <ulink url="unix-install-howto_fr.html">http://mapserver.gis.umn.edu/doc/unix-install-howto.html</ulink>.  
             </para>
        <para>
          <itemizedlist>
            <listitem>
              <para>Le script principal de configuration de MapServer paramètrera automatiquement le makefile pour compiler <filename>php_mapscript.so</filename> si vous donnez l'argument <parameter>--with-php=DIR</parameter> à ce script.
                            </para>
            </listitem>
            <listitem>
              <para>Copiez la bibliothèque <filename>php_mapscript.so</filename> dans votre répertoire d'extensions PHP, et ensuite utilisez la fonction <function>dl()</function> pour charger le module au début de vos scripts PHP.  Voyez aussi la fonction PHP <ulink url="http://www.php.net/manual/en/function.extension-loaded.php">
                  <function>extension_loaded()</function>
                </ulink> pour  vérifier que l'extension est correctement chargée.
                </para>
            </listitem>
            <listitem>
              <para>Le fichier <filename>mapscript/php3/examples/phpinfo_mapscript.phtml</filename> testera que le module php_mapscript est correctement installé et peut être chargé.
                   </para>
            </listitem>
            <listitem>
              <para>Si vous obtenez une erreur de PHP indiquant qu'il est impossible de charger la bibliothèque, assurez vous que vous avez bien recompilé et réinstallé PHP avec l'option de bibliothèques dynamiques.  Pour RedHat 5.x et 6.x, celà signifie qu'il faut ajouter "-rdynamic" au CLDFLAGS dans le makefile principal PHP3 après exécution de ./configure. De même assurez vous que tous les répertoires du chemin pour la localisation du php_mapscript.so sont au moins r-x pour l'utilisateur pour le compte duquel le serveur HTTP est exécuté (habituellement 'nobody'), sinon dl() peut se lamenter qu'il ne trouve pas le fichier même s'il est là.
                </para>
            </listitem>
          </itemizedlist>
        </para>
      </sect3>
      <sect3 id="windoze">
        <title>Construire pour Windows</title>
        <itemizedlist>
          <listitem>
            <para>Pour les utilisateurs Windows, il est recommandé de se procurer une version PHP précompilée sur le site MapServer à <ulink url="http://mapserver.gis.umn.edu/win32binaries.html">http://mapserver.gis.umn.edu/win32binaries.html</ulink> ou sur le site de DM Solutions à
<ulink url="http://www.maptools.org/php_mapscript/">http://www.maptools.org/php_mapscript/</ulink>
            </para>
            <para>Si, pour une raison ou une autre, vous avez besoin de compiler votre propre binaire pour Windows reportez vous au fichier README.WIN32 et... que la force soit avec vous!
            </para>
          </listitem>
        </itemizedlist>
      </sect3>
    </sect2>
    <sect2 id="install">
      <title>Installer PHP/Mapscript</title>
      <itemizedlist>
        <listitem>
          <para>Copiez simplement le fichier <filename>php4_mapscript.dll</filename> dans votre répertoire PHP3/PHP4</para>
          <para>Pour PHP4, placez le fichier dans le sous-répertoire <emphasis>pathto/php/extensions</emphasis>.
          </para>
          <para>Pour PHP3, placez le fichier dans le sous-répertoire <emphasis>pathto/php3</emphasis>.
          </para>
        </listitem>
      </itemizedlist>
    </sect2>
    <sect2 id="verify">
      <title>Utilisation de phpinfo()</title>
      <para>Pour vérifier que PHP et PHP/Mapscript sont bien installés, créez un fichier '.php' contenant le code suivant et essayez d'y accéder via votre serveur HTTP:
      </para>
      <programlisting>
    &lt;HTML&gt;
    &lt;BODY&gt;

    &lt;?php 
    if (PHP_OS == "WINNT" || PHP_OS == "WIN32")
    {
      dl("php_mapscript.dll");
    }
    else
    {
      dl("php_mapscript.so");
    }
    phpinfo();
    ?&gt;

   &lt;/BODY&gt;
   &lt;/HTML&gt;
      </programlisting>
      <para>Si PHP et PHP/Mapscript sont installés correctement, plusieurs tables devraient s'afficher sur votre navigateur, et 'Mapscript' devrait se trouver dans la table 'Extensions'.
      </para>
    </sect2>
    <sect2 id="example">
      <title>Exemple pour une installation Windows complète</title>
      <sect3 id="foxserv">
        <title>En utilisant le projet Project FoxServ de SourceForge</title>
        <orderedlist numeration="lowerroman">
          <listitem>
            <para>Téléchargez <ulink url="http://sourceforge.net/projects/foxserv/">FoxServ</ulink> et double-cliquez sur le fichier exe pour commencer l'installation.   
            </para>
            <note>
              <para>FoxServ devrait être installé dans le répertoire racine(c:/FoxServ) de manière à ce que Apache fonctionne correctement.
              </para>
            </note>
          </listitem>
          <listitem>
            <para>Renseignez l'adresse mel et le nom de l'hôte, comme suit:         
            </para>
            <programlisting>
    email: your_company.com
    hostname: 127.0.0.1           
            </programlisting>
          </listitem>
          <listitem>
            <para>Après installation, lancez Apache, ouvrez votre navigateur et mettez <ulink url="http://127.0.0.1/">http://127.0.0.1/</ulink> dans l'adresse URL. Vous devriez voir une page FoxServ avec la date et quelques autres informations en haut à droite si Apache et PHP ont été correctement installés.
            </para>
          </listitem>
          <listitem>
            <para>Créez un répertoire temporaire pour stocker les images GIF créées par MapServer.
              <emphasis>NOTE: Ce répertoire est spécifié dans le paramètre IMAGEPATH de l'objet WEB dans le fichier <ulink url="mapfile-reference_fr.html">MapFile</ulink>
              </emphasis>. Pour cet exemple nous appellerons ce répertoire “ms_tmp” (par exemple E:/tmp/ms_tmp).
            </para>
          </listitem>
          <listitem>
            <para>Cherchez le fichier ‘httpd.conf’ dans le répertoire ‘conf’ de Apache, et ouvrez le dans un éditeur de texte (comme TextPad, Emacs, Notepad).
            </para>
            <para>Pour paramétrer PHP comme un CGI et non comme un module Apache, commentez la ligne suivante:
            </para>
            <programlisting>
    LoadModule php4_module pathto/FoxServ/php/sapi/php4apache.dll
            </programlisting>
            <para>Dans la section “Action” de ce fichier, ajoutez une action pour le fichier php.exe:
            </para>
            <programlisting>
    Action application/x-httpd-php "/cgi-php/php.exe"       
            </programlisting>
            <para>Dans la section “ScriptAlias” de ce fichier, ajoutez un alias pour le répertoire PHP:
            </para>
            <programlisting>
    ScriptAlias /cgi-php/ "pathto/FoxServ/php/"       
            </programlisting>
            <para>Dans la section “Alias” de ce fichier, ajoutez des alias pour le répertoire ms_tmp et tout autre répertoire nécessaire (pour cet exemple nous utiliserons le répertoire “msapps”):
            </para>
            <programlisting>
    Alias   /ms_tmp/  "path/to/ms_tmp/"
    Alias   /msapps/  "path/to/msapps/"
            </programlisting>
          </listitem>
          <listitem>
            <para>Placez le fichier <filename>php_mapscript.dll</filename> dans votre répertoire <emphasis>FoxServ/php/extensions</emphasis>. 
          </para>
          </listitem>
          <listitem>
            <para>Pour vérifier que PHP et PHP/Mapscript sont correctement installés, créez un fichier '.php' contenant le code suivant et essayez d'y accéder via votre serveur HTTP:              </para>
            <programlisting>
    &lt;HTML&gt;
    &lt;BODY&gt;

    &lt;?php 
      dl("php_mapscript.dll");
      phpinfo();
    ?&gt;

   &lt;/BODY&gt;
   &lt;/HTML&gt;
      </programlisting>
            <para>Si PHP et PHP/Mapscript sont bien installés, plusieurs tableaux devraient être affichés sur votre page, et une section Mapscript devrait apparaître, semblable à:     
      </para>
            <programlisting>
    Mapscript:
    MapScript Version (Jan 9, 2001)
    MapServer Version 3.4 -GD_1_2 -PROJ.4 -FreeType -TIFF -EPPL7 -JPEG -OGR
      </programlisting>
          </listitem>
        </orderedlist>
      </sect3>
      <sect3 id="apache">
        <title>Installation manuelle en utilisant le serveur Apache</title>
        <orderedlist numeration="lowerroman">
          <listitem>
            <para>Téléchargez le <ulink url="http://httpd.apache.org/">Apache Web Server</ulink> et extrayez le dans un répertoire (par exemple D:/Apache).
                </para>
          </listitem>
          <listitem>
            <para>Téléchargez <ulink url="http://www.php.net/">PHP4</ulink> et extrayez le dans votre répertoire Apache (par exemple D:/Apache/PHP4).
                </para>
          </listitem>
          <listitem>
            <para>Créez un répertoire temporaire pour stocker les images GIF créées par MapServer.
                  <emphasis>NOTE: Ce répertoire est spécifié dans le paramètre IMAGEPATH de l'objet WEB dans le <ulink url="mapfile-reference_fr.html">MapFile</ulink>
              </emphasis>. Pour cet exemple nous appellerons ce répertoire temporaire  ms_tmp (par exemple E:/tmp/ms_tmp).
                </para>
          </listitem>
          <listitem>
            <para>Cherchez le fichier httpd.conf dans le répertoire conf de Apache, et ouvrez le dans un éditeur de texte (par exemple TextPad, Emacs, Notepad).
                </para>
            <para>Dans la section Alias de ce fichier, ajoutez les alias vers le répertoire ms_tmp folder et vers tout autre répertoire nécessaire (pour cet exemple nous utiliserons le répertoire msapps):
                </para>
            <programlisting>
    Alias   /ms_tmp/   "path/to/ms_tmp/"
    Alias   /msapps/   "path/to/msapps/"
            </programlisting>
            <para>Dans la section ScriptAlias de ce fichier, ajoutez un alias pour le répertoire PHP4.
                </para>
            <programlisting>
    ScriptAlias    /cgi-php4/     "pathto/apache/php4/"           
                </programlisting>
            <para>Dans la section AddType de ce fichier, ajoutez un type pour les fichiers php4.
                </para>
            <programlisting>
    AddType application/x-httpd-php4   .php
                </programlisting>
            <para>Dans la section Action de ce fichier, ajoutez une action pour le fichier php.exe.
                </para>
            <programlisting>
    Action application/x-httpd-php4    "/cgi-php4/php.exe"            
                </programlisting>
          </listitem>
          <listitem>
            <para>Copiez le fichier php4.ini-dist se trouvant dans votre répertoire Apache/php4 vers le répertoire WindowsNT (par exemple c:/winnt), et renommez le en ‘php.ini’ dans le répertoire WindowsNT.
                </para>
          </listitem>
          <listitem>
            <para>Si vous voulez que des extensions particulières soient chargées par défaut, ouvrez le fichier 'php.ini' dans un éditeur de texte et enlevez la marque de commentaire pour l'extension souhaitée.
                </para>
          </listitem>
          <listitem>
            <para>Placez le fichier <filename>php_mapscript.dll</filename> dans votre répertoire <emphasis>Apache/php4/extensions</emphasis>.
            </para>
          </listitem>
        </orderedlist>
      </sect3>
      <sect3 id="iis">
        <title>Installation pour Microsoft's IIS</title>
        <para>
          <emphasis>Non traduite</emphasis>
        </para>
        <orderedlist numeration="lowerroman">
          <listitem>
            <para>
                  Install IIS if required (see the IIS 4.0 installation procedure at <ulink url="http://support.microsoft.com/support/iis/install/install_iis4.asp">http://support.microsoft.com/support/iis/install/install_iis4.asp</ulink>). 
                </para>
          </listitem>
          <listitem>
            <para>
                  Install PHP and PHP/Mapscript (see above).
                </para>
          </listitem>
          <listitem>
            <para>
                  Open the Internet Service Manager (eg. C\WINNT\system32\inetsrv\inetmgr.exe).
                </para>
          </listitem>
          <listitem>
            <para>
                  Select the Default web site and create a virtual directory (right click, select                         New/Virtual directory). <emphasis>For this example we will call the directory                         "msapps"</emphasis>.
                </para>
          </listitem>
          <listitem>
            <para>
                  In the Alias field enter "msapps" and click Next. 
                </para>
          </listitem>
          <listitem>
            <para>
                  Enter the path to the root of your application (eg. "c:\msapps") and click Next. 
                </para>
          </listitem>
          <listitem>
            <para>
                  Set the directory permissions and click Finish.
                </para>
          </listitem>
          <listitem>
            <para>
                  Select the msapps virtual directory previously created and open the directory                       property sheets (by right clicking and selecting properties) and then click on the Virtual                    directory tab. 
                </para>
          </listitem>
          <listitem>
            <para>
                  Click on the Configuration button and then click the App Mapping tab. 
                </para>
          </listitem>
          <listitem>
            <para>
                  Click Add and in the Executable box type: path\to\php4\php.exe %s %s. You MUST have                     the %s %s on the end, PHP will not function properly if you fail to do this. In the Extension                     box, type the file name extension to be associated with your PHP scripts. Usual extensions                    needed to be associated are phtml and php. You must repeat this step for each extension. 
                </para>
          </listitem>
          <listitem>
            <para>
                     Create a temp directory in Explorer to store MapServer created GIFs.
                  <emphasis>NOTE: This directory is specified in the IMAGEPATH parameter of the WEB Object in the <ulink url="mapfile-reference_fr.html">MapFile</ulink>
              </emphasis>. For this                     example we will call the temp directory “ms_tmp” (eg. C:\tmp\ms_tmp).
                </para>
          </listitem>
          <listitem>
            <para>
                  Open the Internet Service Manager again.
                </para>
          </listitem>
          <listitem>
            <para>
                  Select the Default web site and create a virtual directory called ‘ms_tmp’ (right click, select                     New/Virtual directory). Set the path to the ms_tmp directory (eg. C:\tmp\ms_tmp) . The                    directory permissions should at least be set to Read/Write Access. 
                </para>
          </listitem>
        </orderedlist>
      </sect3>
    </sect2>
  </sect1>
  <!-- Section1: FAQ -->
  <sect1 id="FAQ">
    <title>FAQ / Common Problems</title>
    <sect2>
      <title/>
      <qandaset defaultlabel="qanda">
        <qandadiv>
          <title>Questions concernant la documentation</title>
          <qandaentry>
            <question>
              <para>Existe-t-il d'autres documentations disponibles? 
            </para>
            </question>
            <answer>
              <para>La documentation principale de référence <ulink url="phpmapscript-class-guide_fr.html">PHP/Mapscript Class Reference Guide</ulink>, qui décrit toutes les classes, propriétés et méthodes associées au module PHP/Mapscript. 
              </para>
              <para>Pour avoir une description complète de chaque classe et des variables associées, voyez la documentation MapServer MapScript à: <ulink url="mapscript_fr.html">http://mapserver.gis.umn.edu/mapscript.html</ulink> et la documentation MapFile à: <ulink url="mapfile_fr.html">http://mapserver.gis.umn.edu/mapfile.html</ulink>.                   
              </para>
            </answer>
          </qandaentry>
          <qandaentry>
            <question>
              <para>
              Où puis-je trouver d'autres exemples de scripts?
            </para>
            </question>
            <answer>
              <para>Quelques exemples sont inclus dans le répertoire  mapserver/mapscript/php3/examples/ dans les sources de MapServer. Le plus simple est de commencer avec le script 'test_draw_map.phtml': il est vraiment très simple et consiste à dessiner une carte, une légende et une barre d'échelle dans une page HTML. 
            </para>
              <para>Malheureusement il n'y a pas d'intermédiaire... avec l'exemple suivant qui est <ulink url="http://www2.dmsolutions.ca/gmap/gmap75.phtml">GMap demo</ulink>. Vous pouvez télécharger l'ensemble du source et des fichiers de données sur <ulink url="http://www.maptools.org/dl">http://www.maptools.org/dl</ulink>.
            </para>
            </answer>
          </qandaentry>
        </qandadiv>
        <qandadiv>
          <title>Questions au sujet de l'installation</title>
          <qandaentry>
            <question>
              <para>Comment m'assurer que le module est bien installé sur mon serveur? 
            </para>
            </question>
            <answer>
              <para>Premièrement, copiez la page de test PHP mapserver/mapscript/php3/examples/phpinfo_mapscript.phtml et essayez d'y accéder via votre server HTTP. Si vous n'obtenez aucune erreur et que le module MapScript est montré en fin de liste des modules PHP suite au phpinfo(), alors c'est que le module est correctement installé. 
            </para>
              <para>Vous pouvez essayer en second test la page mapserver/mapscript/php3/examples/test_draw_map.phtml. Cette page ouvre simplement un fichier .map dans  MapServer et inserre cette carte, légende et barre d'échelle dans une page HTML. Modifiez cette page pour accéder à vos propres fichiers .map avec MapServer, et si vous obtenez le résultat attendu alors c'est que tout fonctionne bien, probablement. 
            </para>
            </answer>
          </qandaentry>
          <qandaentry>
            <question>
              <para>J'essaye d'afficher ma page .phtml ou .php dans mon navigateur mais la page s'affiche comme si j'étais sous Notepad. 
            </para>
            </question>
            <answer>
              <para>Le problème est que votre installation PHP ne reconnaît pas ".phtml" comme une extension de fichier PHP.  Vérifiez que vous utilisez bien  PHP4 sous Apache et que vous avez ajouté la ligne suivante, avec les autres lignes relatives aux types reconnus par PHP, dans le httpd.conf:
            </para>
              <programlisting>
    AddType application/x-httpd-php .phtml 
            </programlisting>
              <para>Pour une explication détaillée voyez la partie <link linkend="example">"Exemple d'une installation complète sous Windows"</link> de ce document.
            </para>
            </answer>
          </qandaentry>
          <qandaentry>
            <question>
              <para>J'ai compilé php_mapscript.so sur une RedHat 6.2, il se charge normalement et est listé par le phpinfo(), mais "ça plante" dès que j'essaye d'ouvrir un fichier .map. Qu'est-ce qui ne va pas? 
            </para>
            </question>
            <answer>
              <para>Sur RedHat 6.2, Apache est compilé avec l'option -DEAPI qui apparemment a une incidence sur les modules DSO tel que libphp3.so. Je ne comprend pas ce que -DEAPI fait exactement, mais ça a un impact sur la manière de compiler php_mapscript.so. 
            </para>
              <para>Vous devez installer apache-devel-1.3.12-2.i386.rpm, refaire la configuration de votre répertoire source PHP avec l'option --with-apxs (et tous les autres éléments avec lesquels RH6.2 libphp3.so avait été compilé), et ensuite exécuter configure dans le répertoire mapserver avec l'option --with-apxs. 
            </para>
              <para>Ensuite recompilez php_mapscript.so (make clean; make), copiez le dans /usr/lib/apache et tout devrait "tomber en marche". 
            </para>
              <para>Voyez le <ulink url="http://www2.dmsolutions.ca/mapserver/php_mapscript/php_mapscript_redhat.html">step by step instructions for RedHat               users</ulink> pour plus de détails.
            </para>
            </answer>
          </qandaentry>
          <qandaentry>
            <question>
              <para>J'ai installé le rpm PROJ.4 téléchargé chez remotesensing.org sur mon système, il est reconnu par le script "configure" de MapServer comme une bibliothèque système mais à l'exécution j'ai l'erreur: "libproj.so.0: No such file or directory". 
            </para>
            </question>
            <answer>
              <para>Vous êtes probablement sous un système RedHat Linux si ça vous arrive. La cause en est que l'installation RPM est elle-même sous /usr/local/lib mais que ce répertoire ne fait pas partie du path des bibliothèques exécutables. 
            </para>
              <para>(Je suis très surpris que le "configure" trouve proj.4 comme une bibliothèque système puisqu'il n'est pas dans le path des bibliothèque système... c'est probablement la magie de l'informatique ou de autoconf, il faudra vérifier cette information) 
            </para>
              <para>Il y a trois solutions possibles:
            </para>
              <literallayout>
                  1. Ajoutez un "setenv LD_LIBRARY_PATH" à votre httpd.conf qui contient ce répertoire
                  2. Editez le /etc/ld.so.conf pour ajouter /usr/local/lib, puis exécutez "/sbin/ldconfig". Ceci ajoutera de manière permanente /usr/local/lib au path correspondant. 
                  3. Configurez MapServer avec les options suivantes:

                         --with-proj=/usr/local --enable-runpath

                      ainsi le répertoire /usr/local/lib figurera en dur dans les fichiers exécutables et .so
          </literallayout>
              <para>Personnellement je préfère l'option 2 parce qu'elle est permanente et s'applique à tout le système. Proj.4 probablement n'est pas le seul paquet qui s'installe dans /usr/local/lib. NdT: personnellement j'ai employé la solution 3 qui marche très bien.
            </para>
            </answer>
          </qandaentry>
          <qandaentry>
            <question>
              <para>J'ai compilé PHP comme un CGI et PHP essaye de charger le php_mapscript.so, j'ai une erreur "undefined symbol: _register_list_destructors". Qu'est-ce qui ne va pas? 
            </para>
            </question>
            <answer>
              <para>Votre PHP n'est probablement pas construit pour permettre l'utilisation des bibliothèques partagées. Le script configure de MapServer doit vous donner un message à propos d'une option à ajouter au makefile de PHP pour permettre l'utilisation des bibliothèques partagées. 
            </para>
              <para>Editez le fichier makefile principal de PHP et ajoutez "-rdynamic" au LDFLAGS en début de fichier, ensuite relinkez PHP. 
            </para>
              <para>Note: Le paramètre actuel pour ajouter quelque chose au LDFLAGS peut varier selon le système que vous utilisez. Pour Linux c'est "-rdynamic", et pour *BSD c'est "-export-dynamic". 
               </para>
            </answer>
          </qandaentry>
          <qandaentry>
            <question>
              <para>Pourquoi je ne peux pas compiler PHP et MapScript avec Freetype? 
            </para>
            </question>
            <answer>
              <para>Vous ne pouvez disposer de Freetype à la fois dans PHP et dans MapServer parce qu'il existe un conflit entre les fichiers gdttf.c et gdcache.c qui sont inclus autant dans PHP que dans MapServer mais sans être identiques. 
            </para>
              <para>Nous essayerons de résoudre ce conflit dans le future, mais en attendant, soit PHP soit MapServer doit être compilé en utilisant --without-ttf. C'est particulièrement important avec PHP4 parce qu'il contient la fonctionnalité TTF par défaut. 
            </para>
            </answer>
          </qandaentry>
          <qandaentry>
            <question>
              <para>MapScript a-t-il besoin que PHP3/PHP4 soit DSO? 
          </para>
            </question>
            <answer>
              <para>Non pas forcément, ça marchera quand-même. 
            </para>
              <para>De toute façon, si PHP a été compilé comme un DSO vous aurez à donner l'option --with-apxs au script configure de MapServer. Il est très important que l'option --with-apxs soit indiquée si  PHP a été compilé comme un DSO Apache, spécialement sur les systèmes comme RedHat 6.2 où Apache est déjà compilé avec l'option -DEAPI qui a un impact sur les modules  DSO. 
            </para>
              <para>Nous avons utilisé le module PHP MapScript avec les 3 configurations suivantes pour Apache:
            <literallayout>
                         A - Avec PHP3 comme un DSO
                         B - Avec PHP3 statiquement lié dans Apache (httpd)
                         C - Avec PHP3 comme un CGI
            </literallayout>
              </para>
              <para>Notez que pour les configurations B et C, l'option "-rdynamic" avait été ajoutée à LDFLAGS pour Apache (configuration B) ou pour PHP (configuration C) de manière à rendre disponible les bibliothèques partagées (php_mapscript.so) depuis votre exécutable statique (httpd ou php). Vous n'avez pas besoin de faire quelque chose de spécial pour la  configuration A puisque la modification est prise en compte immédiatement ou quand Apache est compilé pour les modules DSO. 
            </para>
            </answer>
          </qandaentry>
          <qandaentry>
            <question>
              <para>Quelles sont les meilleures combinaisons de versions de Mapscript et PHP?
              </para>
            </question>
            <answer>
              <para>Les meilleures combinaisons sont:
            </para>
              <itemizedlist>
                <listitem>
                  <para>Mapscript 3.4 avec PHP4.0.4p11 ou 4.0.5 (ne fonctionne pas avec PHP4.0.6).
                </para>
                </listitem>
                <listitem>
                  <para>Mapscript 3.5 avec PHP4.0.5 ou 4.0.6 ( comme avec 4.0.4p11).
                </para>
                </listitem>
              </itemizedlist>
            </answer>
          </qandaentry>
        </qandadiv>
        <qandadiv>
          <title>Questions générales</title>
          <qandaentry>
            <question>
              <para>Je fais fonctionner PHP 4.0.6 et j'ai un crash ou des erreurs "Invalid _handle_" lorsque j'appelle map-&gt;getLayer(). 
            </para>
            </question>
            <answer>
              <para>Il y avait un problème avec le module PHP/MapScript dans la version 3.4 (et la version de développement 3.5 jusqu'au 20/07/2001) qui causait des crash ou des erreurs aléatoires lors du lancement avec PHP4.0.6, la plupart du temps avec l'appel de map-&gt;getLayer(). Ceci intervenait aussi bien sous Windows que sous Unix. 
            </para>
              <para>Voyez <ulink url="http://mapserver.gis.umn.edu/bugs/show_bug.cgi?id=23">Bug #23</ulink> pour plus de détails sur ce bug. 
            </para>
              <para>La solution est d'utiliser MapServer 3.5 (version de développement postérieure au 20/07/2001) avec PHP4.0.6 ou plus récent, ou MapServer 3.4 avec PHP4.0.5 ou plus ancien. PHP3 n'était pas affecté par ce problème. 
            </para>
              <para>Notez que les anciennes versions de MapServers comme 3.4 ou 3.3.011 avec PHP 4.0.6 ne sont pas susceptibles de résoudre le problème. 
            </para>
            </answer>
          </qandaentry>
        </qandadiv>
      </qandaset>
    </sect2>
  </sect1>
  <!-- Section1: Document Info -->
  <sect1 id="docinfo">
    <title>A propos de ce document</title>
    <sect2 id="copyright">
      <title>Information de Copyright</title>
      <para>
                Copyright (c) 2001, Jeff McKenna, DM Solutions Group Inc.
            </para>
      <para>Ce document est protégé par la même licence Open Source que le logiciel MapServer lui-même.  Voyez la page <ulink url="license_fr.html">Licence et Remerciements</ulink> de MapServer pour le texte complet.
            </para>
    </sect2>
    <sect2 id="disclaimer">
      <title>Avertissement</title>
      <para>Aucune responsabilité pour le contenu de ce document ne peut être acceptée. Utilisez les concepts, exemples et autres éléments à vos risques et périls. Comme il s'agit d'une nouvelle version  de ce document, il peut y persister des erreurs et omissions qui pourraient endommager votre système. Aussi il est expressément conseillé, l'auteur et le traducteur n'assurant aucune responsabilité, de procéder avec précaution.
      </para>
    </sect2>
    <!-- Section2: feedback -->
    <sect2 id="feedback">
      <title>Feedback</title>
      <para>Envoyez toutes vos suggestions et commentaires à l'auteur, ou au traducteur.
        </para>
    </sect2>
  </sect1>
</article>
