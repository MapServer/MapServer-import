<html>
  <head>
      <title>MapServer - Documentation: Template File Reference</title>
      <script language="javascript" src="javascript/include.js"></script>
  </head>
  <body bgcolor="#FFFFFF" marginheight=0 marginwidth=0 style="margin:0px">

    <script language="javascript">header("doc");</script>

    <a name="top"></a>
    <FONT COLOR="#3366cc" face="arial,helvetica" SIZE=+2><B>Template File Reference</B></FONT>
    <p>
    <b>Purpose</b>: Templates are used to define the look of an interface and to guide the presentation of results, either a query or a map, to the user. A template can be either
    a URL (eg. http://www.somewhere.com/[ATTRIBUTE]/info.html) or HTML file(s). Simple pan/zoom interfaces use a single template file while compilicated queries often require many
    templates. URL templates can only be used with simple QUERY or ITEMQUERY results so many substitutions defined below are not available.
    <p>
    <b>Notes:</b> Template substitution strings <b>are</b> case sensitive. Attribute item substitutions must be the same case as the item names in the dbase file. ArcView and 
    ArcInfo generally produce dbase files with item names that are all uppercase. Appropriate URL encoding (i.e. ' ' to '+') is applied when templates are URLs.
    <p>
    <b>Format</b>: Templates are simply HTML files or URL strings that contains special characters that are  replaced by mapserv each time the template is processed. The simple 
    substitution allows information such as active layers or the spatial extent to be passed from the user to mapserv and back again.  Most often the new values are dumped into  
    form variables that will be passed on again. The list of special characters and form variables is given below. HTML templates can include just about anything including javascript 
    and java calls.

    <menu>
      <li> <b>[id]</b>: Unique session id. The id can be passed in via a form but is more commonly generated by the software. In that case the id is a concatenation of UNIX time (or NT equivalent) and the process id. Unless your getting more requests in a second than allowable process ids the id can be considered unique. ;->
      <li> <b>[get_layers]</b>: All active layers formated for inclusion in a URL. (i.e. layer=layer1&layer=layer2 and so on...)
      <li> <b>[layers]</b>: All active layers space delimited.
      <li> <b>[<i>layername</i>_check|select]</b>: Used for making layers persistant across a map creation session. String is replaced with the keyword "checked", "selected" or "" 
      if <i>layername</i> is on. Layername is the name of a layer as it appears in the <a href="mapfile.html">map file</a>.
      <li> <b>[<i>layername</i>_desc]</b>: Used for accessing the layer DESCRIPTION for active layers and NOT default layers. Replaced with an empty string if the layer is OFF.
      <li> <b>[<i>layername</i>_leg]</b>: Used for accessing the layer LEGEND for active layers and NOT default layers. Replaced with an empty string if the layer is OFF.

      <p>
      <li> <b>[mapx]</b>: X coordinate of mouse click.
      <li> <b>[mapy]</b>: Y coordinate of mouse click.
      <li> <b>[mapext]</b>: Full mapextent (seperated by spaces).
      <li> <b>[minx]</b>: Minimum X coordinate of new map extent.
      <li> <b>[miny]</b>: Minimum Y coordinate of new map extent.
      <li> <b>[maxx]</b>: Maximum X coordinate of new map extent.
      <li> <b>[maxy]</b>: Maximum Y coordinate of new map extent.
      <li> <b>[rawext]</b>: Raw mapextent, that is the extent before fitting to a window size (seperated by spaces). In cases where input came from imgbox (via Java or whatever) rawext refers to imgbox coordinates transformed to map units.
      <li> <b>[rawminx]</b>: Minimum X coordinate of aww map/search extent.
      <li> <b>[rawminy]</b>: Minimum Y coordinate of raw map/search extent.
      <li> <b>[rawmaxx]</b>: Maximum X coordinate of raw map/search extent.
      <li> <b>[rawmaxy]</b>: Maximum Y coordinate of raw map/search extent.

      <p>
      <li> <b>[mapsize]</b>: Current image size in cols and rows (seperated by spaces).
      <li> <b>[mapwidth]</b>: Current image width.
      <li> <b>[mapheight]</b>: Current image width.
      <li> <b>[center]</b>: Computed image center in pixels. Useful for setting imgxy form variable when map sizes change.
      <li> <b>[center_x]</b>: Computed image center x coordinate in pixels.
      <li> <b>[center_y]</b>: Computed image center y coordinate in pixels.

      <p>
      <li> <b>[img]</b>: Path (relative to document root) of new image, just the image name if IMAGE_URL is not set in the mapfile
      <li> <b>[ref]</b>: Path (relative to document root) of new reference image.
      <li> <b>[legend]</b>: Path (relative to document root) of new legend image.
      <li> <b>[scalebar]</b>: Path (relative to document root) of new scalebar image.

      <p>
      <li> <b>[scale]</b>: Current image scale.
      <li> <b>[host]</b>: Hostname of the web server.
      <li> <b>[port]</b>: Port the web server is listening to.
      <li> <b>[pid]</b>: Process ID.
      <li> <b>[time]</b>: Time() at the begining of the MapServer execution. Used with the process ID to build unique file names.

      <p>
      <li> <b>[zoom_minzoom to maxzoom_check|select]</b>: Used for making the zoom factor persistant. Zoom values can range from -25 to 25 by default. The string is replaced with the HTML keyword "checked", "selected" or "" depending on the current zoom value.
      <li> <b>[zoomdir_-1|0|1_check|select]</b>: Used for making the zoom direction persistant. Use check with a radio control or select with a selection list. See the demo for an example. The string is replaced with the HTML keyword "checked", "selected" or "" depending on the current value of zoomdir.

      <p>
      <li> <b>[post or get variable name]</b>: The contents of any variables passed to the MapServer, whether they were used or not, can be echoed this way. One use might be to have the user set a map title or north arrow style in an interactive  map composer. The system  doesn't care about the values, but they might be real important in creating the final output.

      <li> <b>[DBASE item name]</b>: Item name from the attribute table of a queried layer. Only attributes for the active query layers are accessible. Case must be the same as what is stored in the DBASE file. ArcView, for example, uses all caps for shapefile field names.
      <li> <b>[shpext]</b>: Extent of current shape plus a 5 percent buffer. Available only when processing query results.
      <li> <b>[shpidx]</b>: Index value of the current shape.
      <li> <b>[shpmid]</b>: Middle of the extent of current shape. Available only when processing query results.
      <li> <b>[shpminx]</b>: Minimum X coordinate of shape extent.
      <li> <b>[shpminy]</b>: Minimum Y coordinate of shape extent.
      <li> <b>[shpmaxx]</b>: Maximum X coordinate of shape extent.
      <li> <b>[shpmaxy]</b>: Maximum Y coordinate of shape extent.

      <p>
      <li> <b>[zoom_minzoom to maxzoom_check|select]</b>: Used for making the zoom factor persistant. Zoom values can range from -25 to 25 by default. The string is replaced with the HTML keyword "checked", "selected" or "" depending on the current zoom value.
      <li> <b>[zoomdir_-1|0|1_check|select]</b>: Used for making the zoom direction persistant. Use check with a radio control or select with a selection list. See the demo for an example. The string is replaced with the HTML keyword "checked", "selected" or "" depending on the current value of zoomdir.

      <p>
      For query modes that allow for multiple result sets, the following string substitutions are available. For FEATURESELECT and FEATURENSELECT
      modes the totals are adjusted so as not to include the selection layer. The selection layer results ARE available for display to the user.
      <p>
      <li> <b>[cl]</b>: Current layer name. Useful in layer headers and footers.
      <li> <b>[cld]</b>: Current layer description. Useful in layer headers and footers.
      <li> <b>[lrn]</b>: Result number within the current layer. Starts at 1. Useful in query templates.
      <li> <b>[nl]</b>: Number of layers returning results. Useful in web header and footers.
      <li> <b>[nr]</b>: Total number of results. Useful in web header and footers.
      <li> <b>[rn]</b>: Result number within all query results. Starts at 1. Useful in web header and footers.

    </menu>

  <script language="javascript">footer();</script>
