.. _union:

*****************************************************************************
 Union Layer
*****************************************************************************

:Author: Tamas Szekeres
:Contact: szekerest at gmail.com
:Last Updated: 2011-03-08

The union layer provides the option to represent features from multiple 
layers (called as 'source layers') in a single layer. This functionality
has been added according to :ref:`rfc68`.

Map File Example
-----------------

* The CONNECTIONTYPE parameter must be set to UNION.
* The CONNECTION parameter must contain the comma separated list of the source layers.
* All of the source layers and the union layer must have the same TYPE.
* At your convenience you may disable the visibility of the source layers to avoid to display the features twice.

::

	LAYER
        CONNECTIONTYPE UNION
        CONNECTION "layer1,layer2,layer3" # reference to the source layers
        TYPE POINT
        NAME "union-layer"
        PROCESSING "ITEMS=itemname1,itemname2,itemname3"
        STATUS default
        ...
    END
    LAYER
      CONNECTIONTYPE OGR
      CONNECTION ...
      TYPE POINT
      NAME layer1
      STATUS off
      ...
    END
    LAYER
      CONNECTIONTYPE SHAPE
      CONNECTION ...
      TYPE POINT
      NAME layer2
      STATUS off
      ...
    END
    LAYER
      CONNECTIONTYPE SHAPE
      CONNECTION ...
      TYPE POINT
      NAME layer3
      STATUS off
      ...
    END

    
Data Access / Connection Method
-------------------------------

This is a native MapServer option that doesn't use any external libraries to support it. The CONNECTION
parameter must contain the name of the source layers from which the features are actually retrieved.
    
Feature attributes
------------------

In the LAYER definition you may refer to any attributes supported by each of the source layers.
In addition to the source layer attributes the union layer provides the following additional attributes:

1) Combine:SourceLayerName - The name of the source layer the feature belongs to
2) Combine:SourceLayerGroup - The group of the source layer the feature belongs to

During the selection / feature query operations only the 'Combine:SourceLayerName' and 'Combine:SourceLayerGroup'
attributes are provided by default. The set of the provided attributes can manually be overridden 
(and further attributes can be exposed) by using the ITEMS processing option (refer to the example above).

Classes and Styles
------------------

We can define the symbology and labelling for the union layers in the same way as for
any other layer by specifying the classes and styles. In addition the STYLEITEM AUTO 
option is also supported for the union layer, which provides to display 
the features as specified at the source layers. The source layers 
may also use the STYLEITEM AUTO setting if the underlying data source provides that.

Projections
-----------

It is suggested to use the same projection of the union layer and the source layers. The layer provider
however supports transforming the feature positions between the source layers and the union layer.

